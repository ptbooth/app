(function(){"use strict";var e={2941:function(e,t,a){a(8111),a(7588);var n=a(5130),i=a(6768);const l={class:"model-login-require"};function s(e,t,a,n,s,o){const r=(0,i.g2)("App"),c=(0,i.g2)("component__download_gui"),d=(0,i.g2)("component__font-picker"),h=(0,i.g2)("n-carousel-item"),u=(0,i.g2)("n-carousel"),p=(0,i.g2)("n-divider"),g=(0,i.g2)("n-button"),_=(0,i.g2)("n-flex"),m=(0,i.g2)("n-card"),f=(0,i.g2)("n-modal"),b=(0,i.g2)("n-image"),k=(0,i.g2)("n-loading-bar-provider"),v=(0,i.g2)("n-notification-provider"),y=(0,i.g2)("n-message-provider"),w=(0,i.g2)("n-dialog-provider"),x=(0,i.g2)("n-config-provider");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(x,{theme:e.darkTheme,locale:e.viVN,"date-locale":e.dateViVN},{default:(0,i.k6)(()=>[(0,i.bF)(w,null,{default:(0,i.k6)(()=>[(0,i.bF)(y,null,{default:(0,i.k6)(()=>[(0,i.bF)(v,null,{default:(0,i.k6)(()=>[(0,i.bF)(k,null,{default:(0,i.k6)(()=>[(0,i.bF)(r),(0,i.bF)(c),(0,i.bF)(d),(0,i.bF)(f,{show:e.show_login,"onUpdate:show":t[1]||(t[1]=t=>e.show_login=t)},{default:(0,i.k6)(()=>[(0,i.Lk)("div",l,[(0,i.bF)(u,{style:{height:"180px",overflow:"hidden"},autoplay:""},{default:(0,i.k6)(()=>[(0,i.bF)(h,null,{default:(0,i.k6)(()=>[...t[2]||(t[2]=[(0,i.Lk)("img",{src:"https://file.hstatic.net/200000722513/file/tao-anh-bang-ai-1_b6ce6d48bcd54433be01dc947c0d875e_1024x1024.jpg",alt:"image"},null,-1)])]),_:1}),(0,i.bF)(h,null,{default:(0,i.k6)(()=>[...t[3]||(t[3]=[(0,i.Lk)("img",{src:"https://cdn-media.sforum.vn/storage/app/media/wp-content/uploads/2023/07/hinh-nen-ai-98.jpg",alt:"image"},null,-1)])]),_:1})]),_:1}),(0,i.bF)(m,null,{default:(0,i.k6)(()=>[t[6]||(t[6]=(0,i.Lk)("div",{class:"title"},"Yêu cầu đăng nhập!",-1)),t[7]||(t[7]=(0,i.Lk)("div",{class:"desc",style:{"margin-top":"8px"}},"Hãy đăng nhập để sử dụng những tính năng đặc biệt mà chúng tôi dành riêng cho bạn. ",-1)),(0,i.bF)(p),(0,i.bF)(_,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(g,{size:"large",ghost:"",type:"primary",onClick:t[0]||(t[0]=t=>e.show_login=!1)},{default:(0,i.k6)(()=>[...t[4]||(t[4]=[(0,i.eW)(" Bỏ qua ",-1)])]),_:1}),(0,i.bF)(g,{size:"large",type:"primary",onClick:e.$AF.$appFunc.redirectToGoogleAuth},{default:(0,i.k6)(()=>[...t[5]||(t[5]=[(0,i.Lk)("img",{style:{"background-color":"white",padding:"2px","border-radius":"50%"},src:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Google_%22G%22_logo.svg/768px-Google_%22G%22_logo.svg.png",width:"24px",alt:""},null,-1),(0,i.eW)("   Đăng nhập ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})])]),_:1},8,["show"]),(0,i.bF)(b,{src:e.image_view.path,style:{display:"none"},ref:"image_view"},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["theme","locale","date-locale"])])}var o=a(7342),r=a(3822);function c(e,t,a,n,l,s){const o=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.Wv)(o)}a(4114),a(2489),a(116),a(1701);var d=a(2484),h=a(1387);const u={class:"page__start"},p={class:"overlay-background"};function g(e,t,a,n,l,s){const o=(0,i.g2)("component__start-splash"),r=(0,i.g2)("component__start-quantity"),c=(0,i.g2)("component__start-payment"),d=(0,i.g2)("component__start-capture"),h=(0,i.g2)("component__start-image-pick"),g=(0,i.g2)("component__start-filter-effect"),_=(0,i.g2)("component__start-share"),m=(0,i.g2)("n-spin"),f=(0,i.g2)("n-flex");return(0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("div",p,[e.is_loading?((0,i.uX)(),(0,i.Wv)(f,{key:1,style:{height:"100vh"},align:"center",justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[(0,i.bF)(m,{size:"large"}),t[0]||(t[0]=(0,i.Lk)("div",{style:{"text-align":"center","margin-top":"16px",color:"white"}}," Đang tải cấu hình... ",-1))])]),_:1})):((0,i.uX)(),(0,i.CE)(i.FK,{key:0},["splash"===e.step?((0,i.uX)(),(0,i.Wv)(o,{key:0,onClick:e.onNextStep},null,8,["onClick"])):(0,i.Q3)("",!0),"quantity"===e.step?((0,i.uX)(),(0,i.Wv)(r,{key:1})):(0,i.Q3)("",!0),"payment"===e.step?((0,i.uX)(),(0,i.Wv)(c,{key:2})):(0,i.Q3)("",!0),"capture"===e.step?((0,i.uX)(),(0,i.Wv)(d,{key:3})):(0,i.Q3)("",!0),"image_pick"===e.step?((0,i.uX)(),(0,i.Wv)(h,{key:4})):(0,i.Q3)("",!0),"filter_effect"===e.step?((0,i.uX)(),(0,i.Wv)(g,{key:5})):(0,i.Q3)("",!0),"share"===e.step?((0,i.uX)(),(0,i.Wv)(_,{key:6})):(0,i.Q3)("",!0)],64))])])}const _={class:"start-splash"};function m(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",_,[...t[0]||(t[0]=[(0,i.Lk)("video",{id:"video_background",playsinline:"",autoplay:"",muted:"",loop:""}," Your browser does not support the video tag. ",-1)])])}var f={name:"component__start-splash",data(){return{}},methods:{},mounted(){this.$parent.onNextStep()}},b=a(1241);const k=(0,b.A)(f,[["render",m]]);var v=k,y=(a(4603),a(7566),a(8721),a(1114));class w{constructor({service_port:e,device_id:t=null}){(0,y.A)(this,"getCameras",()=>this.getJson({url_path:"/cameras"})),(0,y.A)(this,"getLUTs",()=>this.getJson({url_path:"/luts"})),(0,y.A)(this,"uploadLUT",async({file:e,name:t})=>{const a=new URL(this.base_url+"/luts/upload"),n=new FormData;n.append("file",e),n.append("name",t);let i=await fetch(a,{method:"POST",body:n});return await i.json()}),(0,y.A)(this,"applyLUTToImage",async({imageFile:e,lutFile:t})=>{const a=new URL(this.base_url+"/luts/apply?lut_file="+encodeURIComponent(t)),n=new FormData;n.append("image",e),n.append("lut_file",t);let i=await fetch(a,{method:"POST",body:n});return await i.blob()}),(0,y.A)(this,"getConfig",()=>this.getJson({url_path:"/config"})),(0,y.A)(this,"updateConfig",e=>this.postJson({url_path:"/config",body:e})),(0,y.A)(this,"getCameraStreamUrl",(e,t={})=>{const a=new URL(this.base_url+`/cameras/${e}`);return Object.keys(t).forEach(e=>a.searchParams.append(e,t[e])),a.toString()}),(0,y.A)(this,"getCameraSnapshotUrl",(e,t={})=>{const a=new URL(this.base_url+"/cameras/snapshot");return Object.keys(t).forEach(e=>a.searchParams.append(e,t[e])),a.toString()}),(0,y.A)(this,"stopCamera",e=>this.getJson({url_path:"/cameras/stream",method:"DELETE"})),(0,y.A)(this,"remoteTuyaCommand",({action:e})=>this.postJson({url_path:"/tuya",body:{action:e}})),(0,y.A)(this,"getBanks",()=>this.getJson({url_path:"/banks"})),(0,y.A)(this,"getPrinters",()=>this.getJson({url_path:"/printers"})),(0,y.A)(this,"printImage",({printer_id:e,imageFile:t,copies:a=1,printer_setting:n={}})=>{const i=new URL(this.base_url+"/printers/print"),l=new FormData;return l.append("printer_id",e),l.append("image",t),l.append("copies",a),l.append("printer_setting",JSON.stringify(n)),fetch(i,{method:"POST",body:l}).then(e=>e.json())}),(0,y.A)(this,"getPrinterSettings",e=>this.getJson({url_path:`/printers/${e}/settings`})),(0,y.A)(this,"updatePrinterSettings",(e,t)=>this.postJson({url_path:`/printers/${e}/settings`,body:t})),(0,y.A)(this,"uploadImage",async({file:e})=>{const t=new URL(this.base_url+"/uploads"),a=new FormData;a.append("image",e);let n=await fetch(t,{method:"POST",body:a});return await n.json()}),(0,y.A)(this,"getUploadedImage",e=>{const t=new URL(this.base_url+`/uploads/${e}`);return t.toString()}),(0,y.A)(this,"listUploadedImages",()=>this.getJson({url_path:"/uploads"})),(0,y.A)(this,"deleteUploadedImage",e=>{let t=encodeURIComponent(e);return fetch(this.base_url+`/uploads/${t}`,{method:"DELETE"}).then(e=>e.json())}),(0,y.A)(this,"listFrames",()=>this.getJson({url_path:"/frames"})),(0,y.A)(this,"getFrame",e=>this.getJson({url_path:`/frames/${e}`})),(0,y.A)(this,"getFrameImageUrl",e=>{const t=new URL(this.base_url+`/frames/${e}/image`);return t.toString()}),(0,y.A)(this,"createOrUpdateFrame",async({frameData:e,imageFile:t})=>{const a=new URL(this.base_url+"/frames"),n=new FormData;n.append("frame_data",JSON.stringify(e)),n.append("image",t);let i=await fetch(a,{method:"POST",body:n});return await i.json()}),(0,y.A)(this,"deleteFrame",e=>{let t=encodeURIComponent(e);return fetch(this.base_url+`/frames/${t}`,{method:"DELETE"}).then(e=>e.json())}),(0,y.A)(this,"getSoundFileUrl",e=>{const t=new URL(this.base_url+`/sounds/${e}`);return t.toString()}),(0,y.A)(this,"uploadImagesToStorage",async({files:e})=>{const t=new URL(this.base_url+"/storages/upload"),a=new FormData;e.forEach(e=>{a.append("images",e)});let n=await fetch(t,{method:"POST",body:a});return await n.json()}),this.service_port=e,this.base_url=`http://localhost:${this.service_port}/api/v1`,this.device_id=t}async getJson({url_path:e,params:t={},method:a="GET"}){const n=new URL(this.base_url+e);Object.keys(t).forEach(e=>n.searchParams.append(e,t[e]));let i=await fetch(n,{method:a||"GET"});return await i.json()}async postJson({url_path:e,body:t={}}){console.log("base_url",this.base_url,"url_path",e,"body",t);const a=new URL(this.base_url+e);let n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await n.json()}async deleteLUT(e){let t=encodeURIComponent(e),a=await fetch(this.base_url+`/luts/${t}`,{method:"DELETE"});return await a.json()}}var x=a(574),F=a.n(x);a(3579);async function C(e,t=[],a=null){if(console.log("renderCanvasFromConfig",e,t,a),!e||!e.els)throw new Error("PageConfig không hợp lệ");const[n,i]=e.size.split("x").map(Number),l=e.dpi||300,s=Math.round(n*l),o=Math.round(i*l),r=document.createElement("canvas");r.width=s,r.height=o;const c=r.getContext("2d");c.fillStyle=e.background_color||"#ffffff",c.fillRect(0,0,s,o);const d=await L(e.els,t,a),h=[...e.els].sort((e,t)=>{const a=parseInt(e.z_index||0,10),n=parseInt(t.z_index||0,10);return a-n});for(const u of h)await E(c,u,d);return new Promise((e,t)=>{r.toBlob(a=>{if(a){const t=URL.createObjectURL(a);e({canvas:r,blob:a,url:t,width:s,height:o})}else t(new Error("Không thể tạo blob từ canvas"))},"image/jpeg",.95)})}async function L(e,t,a){const n={images:{},qrCode:null,imageIndex:0},i=[];for(const o of e)if("image"===o.main_object_class)try{let e=parseInt(o.main_object_id.split(":")[1])-1;if(console.log("el",o,t,e),e>=0&&e<t.length){const a=t[e].url,l=$(a).then(e=>{n.images[o.id]=e}).catch(e=>{console.warn(`Không thể load ảnh cho element ${o.id}:`,e)});i.push(l)}}catch(s){}const l=e.some(e=>"qrcode"===e.main_object_class);if(l)if("blank"!==a){const e=$(a).then(e=>{n.qrCode=e}).catch(e=>{console.warn("Không thể load QR code:",e)});i.push(e)}else n.qrCode="blank";for(const o of e)if(o.image_url&&"image"!==o.main_object_class&&"qrcode"!==o.main_object_class){const e=$(o.image_url).then(e=>{n.images[o.id]=e}).catch(e=>{console.warn(`Không thể load custom image cho element ${o.id}:`,e)});i.push(e)}return await Promise.all(i),n}async function $(e){if(console.log("url",e),e.includes("api/v1/uploads")){const t=await fetch(e+"?is_base64=true");let a=await t.json();const n=a.base64;return await new Promise((t,i)=>{const l=new Image;l.onload=()=>{t(l)},l.onerror=t=>{i(new Error(`Failed to load image from base64: ${e} - ${t.message}`))},l.src="data:"+a.media_type+";base64,"+n})}const t=await fetch(e,{method:"GET"}),a=await t.blob(),n=URL.createObjectURL(a);return await new Promise((t,a)=>{const i=new Image;i.onload=()=>{URL.revokeObjectURL(n),t(i)},i.onerror=t=>{URL.revokeObjectURL(n),a(new Error(`Failed to load image from blob: ${e} - ${t.message}`))},i.src=n})}async function E(e,t,a){e.save(),e.globalAlpha=void 0!==t.opacity?t.opacity:1;const n=t.left+t.width/2,i=t.top+t.height/2;switch(e.translate(n,i),t.rotate_angle&&e.rotate(t.rotate_angle*Math.PI/180),e.translate(-n,-i),A(t)&&(I(e,t.left,t.top,t.width,t.height,{topLeft:t.border_radius_top_left||0,topRight:t.border_radius_top_right||0,bottomLeft:t.border_radius_bottom_left||0,bottomRight:t.border_radius_bottom_right||0}),e.clip()),console.log("el.main_object_class",t.main_object_class),t.main_object_class){case"image":S(e,t,a);break;case"qrcode":"blank"!==a.qrCode&&T(e,t,a);break;case"text":z(e,t);break;default:t.image_url&&a.images[t.id]&&U(e,t,a);break}e.restore(),"qrcode"===t.main_object_class&&a&&("blank"===a.qrCode||a.qrCode)||t.border_width&&t.border_width>0&&(e.save(),e.translate(n,i),t.rotate_angle&&e.rotate(t.rotate_angle*Math.PI/180),e.translate(-n,-i),e.strokeStyle=t.border_color||"#000000",e.lineWidth=t.border_width,A(t)?(I(e,t.left,t.top,t.width,t.height,{topLeft:t.border_radius_top_left||0,topRight:t.border_radius_top_right||0,bottomLeft:t.border_radius_bottom_left||0,bottomRight:t.border_radius_bottom_right||0}),e.stroke()):e.strokeRect(t.left,t.top,t.width,t.height),e.restore())}function S(e,t,a){const n=a.images[t.id];if(!n)return console.log("e",t),e.fillStyle="#f0f0f0",e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle="#999999",e.font=`bold ${t.font_size||16}px ${t.font_family||"Arial"}`,e.textAlign="center",e.textBaseline="middle",e.fillText(t.name||"Image not available",t.left+t.width/2,t.top+t.height/2),e.fillStyle="#f0f0f0",e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle="#999999",e.font=`bold ${t.font_size||16}px ${t.font_family||"Arial"}`,e.textAlign="center",e.textBaseline="middle",void e.fillText(t.name||"Image not available",t.left+t.width/2,t.top+t.height/2);M(e,n,t.left,t.top,t.width,t.height)}function T(e,t,a){const n=a.qrCode;if(!n)return e.fillStyle="#f0f0f0",e.fillRect(t.left,t.top,t.width,t.height),e.strokeStyle="#cccccc",void e.strokeRect(t.left,t.top,t.width,t.height);M(e,n,t.left,t.top,t.width,t.height)}function U(e,t,a){const n=a.images[t.id];n&&M(e,n,t.left,t.top,t.width,t.height)}function z(e,t){t.background_color&&(e.fillStyle=t.background_color,e.fillRect(t.left,t.top,t.width,t.height));let a="";t.font_italic&&(a+="italic "),t.font_bold&&(a+="bold "),e.font=`${a}${t.font_size||12}px ${t.font_family||"Arial"}`,e.fillStyle=t.font_color||"#000000",e.textAlign=t.text_align||"center",e.textBaseline="middle";let n=t.text_content||"";const i=new Date;if(n.includes("[DATE]")||n.includes("[NGAY]")){const e=i.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"});n=n.replace(/\[DATE\]/g,e),n=n.replace(/\[NGAY\]/g,e)}if(n.includes("[TIME]")||n.includes("[GIO_PHUT]")){const e=i.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit",hour12:!1});n=n.replace(/\[TIME\]/g,e),n=n.replace(/\[GIO_PHUT\]/g,e)}const l=t.left+("left"===t.text_align?0:"right"===t.text_align?t.width:t.width/2),s=t.top+t.height/2;if(e.fillText(n,l,s),t.font_underline){const a=e.measureText(n).width,i=s+.1*t.font_size;let o=l;"center"===t.text_align?o=l-a/2:"right"===t.text_align&&(o=l-a),e.strokeStyle=t.font_color||"#000000",e.lineWidth=Math.max(1,.05*t.font_size),e.beginPath(),e.moveTo(o,i),e.lineTo(o+a,i),e.stroke()}}function M(e,t,a,n,i,l){const s=t.width/t.height,o=i/l;let r=0,c=0,d=t.width,h=t.height;s>o?(d=t.height*o,r=(t.width-d)/2):(h=t.width/o,c=(t.height-h)/2),e.drawImage(t,r,c,d,h,a,n,i,l)}function A(e){return(e.border_radius_top_left||0)>0||(e.border_radius_top_right||0)>0||(e.border_radius_bottom_left||0)>0||(e.border_radius_bottom_right||0)>0}function I(e,t,a,n,i,l){const{topLeft:s,topRight:o,bottomLeft:r,bottomRight:c}=l;e.beginPath(),e.moveTo(t+s,a),e.lineTo(t+n-o,a),e.quadraticCurveTo(t+n,a,t+n,a+o),e.lineTo(t+n,a+i-c),e.quadraticCurveTo(t+n,a+i,t+n-c,a+i),e.lineTo(t+r,a+i),e.quadraticCurveTo(t,a+i,t,a+i-r),e.lineTo(t,a+s),e.quadraticCurveTo(t,a,t+s,a),e.closePath()}async function V({pageConfig:e,imageUrls:t=[],qrCodeUrl:a=null,options:n={}}){console.log("options",n,t,a);const i=await C(e,t,a);if(n.merge||e.merge){const t=i.canvas,a=document.createElement("canvas");a.width=2*t.width,a.height=t.height;const l=a.getContext("2d");return l.drawImage(t,0,0),l.drawImage(t,t.width,0),(n.middleCut||e.middle_cut)&&(l.strokeStyle="#cccccc",l.lineWidth=2,l.setLineDash([10,5]),l.beginPath(),l.moveTo(t.width,0),l.lineTo(t.width,t.height),l.stroke(),l.setLineDash([])),new Promise((e,t)=>{a.toBlob(n=>{if(n){const t=URL.createObjectURL(n);e({canvas:a,blob:n,url:t,width:a.width,height:a.height})}else t(new Error("Không thể tạo blob từ merged canvas"))},"image/jpeg",.95)})}if(n.rotate_before_print||e.rotate_before_print){const e=i.canvas,t=document.createElement("canvas");t.width=e.height,t.height=e.width;const a=t.getContext("2d");return a.translate(t.width/2,t.height/2),a.rotate(Math.PI/2),a.drawImage(e,-e.width/2,-e.height/2),new Promise((e,a)=>{t.toBlob(n=>{if(n){const a=URL.createObjectURL(n);e({canvas:t,blob:n,url:a,width:t.width,height:t.height})}else a(new Error("Không thể tạo blob từ rotated canvas"))},"image/jpeg",.95)})}return i}class D extends w{constructor({server:e}){super({}),(0,y.A)(this,"anonymousUploadFile",async({file:e})=>{const t=new URL(this.base_url+"/open-api/anonymous/upload"),a=new FormData;a.append("file",e);let n=await fetch(t,{method:"POST",body:a});return await n.json()}),(0,y.A)(this,"anonymousLibraryCreate",async({image_ids:e})=>this.postJson({url_path:"/open-api/anonymous/library",body:{image_ids:e}})),(0,y.A)(this,"anonymousLibraryAppendImage",async({library_id:e,image_id:t,pwd:a})=>this.postJson({url_path:"/open-api/anonymous/library/append",body:{_id:e,image_id:t,pwd:a}})),(0,y.A)(this,"anonymousGetTransactions",async({api_key:e})=>this.getJson({url_path:"/open-api/anonymous/casso-sepay/transactions",params:{api_key:e}})),this.server=e,this.base_url=this.server+"/api/v1",console.log("ServiceFetchServer initialized with server:",e)}}var X=a(619);class W{static generateFlag(e,t,a=2){return e+t.length.toString().padStart(a,"0")+t}static generateQRData({accountName:e,accountNumber:t,bankCode:a,amount:n,transactionMessage:i}){console.log("args",e,t,a,n,i);let l="000201010212";l+=W.generateFlag("38",W.generateFlag("0010A00000072701",W.generateFlag("",a,4)+W.generateFlag("01",t))+"0208QRIBFTTA"),l+="5303704",l+=W.generateFlag("54",n.toString()),l+="5802VN",l+=W.generateFlag("62",W.generateFlag("08",i)),l+="6304";let s=W.calculateCRC(l);return l+=s,l}static calculateCRC(e){let t=65535;for(let a=0;a<e.length;a++){t^=e.charCodeAt(a)<<8;for(let e=0;e<8;e++)0!==(32768&t)?t=t<<1^4129:t<<=1}return(65535&t).toString(16).toUpperCase().padStart(4,"0")}}var j={name:"mixin_photo_controller",data(){return{step:"splash",step_list:["splash","quantity","payment","capture","image_pick","filter_effect","share"],photos:[],selected_photos:[],photo_index:0,config:{},device_id:null,callback_load_config_complete:null,payment_order_id:"",internal_get_device_config:null,selected_package:null,cameras:[],frame:{loading:!1,list:[],filter:{keyword:""}},is_flipping:!1,countdown:0,sound_map:{},payment_step:{in_process:!1,input_code:"",interval:null,transactions:[],last_trans_id:""},is_headless:!0,selected_lut_file:null}},computed:{is_loading(){return!this.config?.license?.license_to},license_expire_soon(){if(this.config?.license?.license_to){let e=new Date(1e3*this.config.license.license_to),t=new Date,a=e-t,n=Math.ceil(a/864e5);return n<=7}return!1},selected_camera(){return this.cameras.find(e=>e.origin_unique_id===this.config.camera_unique_id)||(this.cameras||[])[0]||null},filtered_frame_list(){let e=this.removeUnicode(this.frame.filter.keyword||"").toLowerCase();return e?this.frame.list.filter(t=>t.slug.includes(e)):this.frame.list},valid_transactions(){let e=this.payment_step.transactions.map(e=>({id:e.id||"",content:e.transaction_content||e.description||"",amount:e.amount_in&&parseFloat(e.amount_in)||e.amount||0}));return e.filter(e=>e.content.includes(this.payment_order_id)&&e.amount>=(this.selected_package?.price||0))}},watch:{step:function(e,t){if("quantity"===this.step){let e=this.config?.packages||[];1===e.length&&1===(e[0]?.items||[]).length&&(this.selected_package=e[0].items[0],this.onNextStep())}"payment"===this.step&&(async()=>{await this.getLastTransaction(),this.payment_step.last_trans_id="",this.valid_transactions.length>0&&(this.payment_step.last_trans_id=this.valid_transactions[0].id),this.startCheckPaymentStatus()})(),"image_pick"===this.step&&this.config.image_temp_max===this.config.image_max&&(async()=>{await this.getAllFrames(),1===this.frame.list.length&&await this.makeLibrary({pageConfig:this.frame.list[0],imageUrls:this.photos})})()}},beforeMount(){this.step=this.step_list[0],this.device_id=this.$route.query.device_id||null,this.$fetch.base=new w({service_port:this.$route.query.port||6696,device_id:this.device_id}),this.getDeviceConfig(),this.getCameraList(),"/setting"!==this.$route.path.toLowerCase()&&(this.internal_get_device_config=setInterval(()=>{this.getDeviceConfig()},12e4))},mounted(){document.addEventListener("keydown",this.handleKeydownEvent)},beforeDestroy(){document.removeEventListener("keydown",this.handleKeydownEvent),this.internal_get_device_config&&(clearInterval(this.internal_get_device_config),this.internal_get_device_config=null)},methods:{async handleKeydownEvent(e){"payment"===this.step&&this.config.payment_bypass_password&&e.key>="0"&&e.key<="9"&&(this.payment_step.input_code+=e.key,(this.config.payment_bypass_password||"").toString().startsWith(this.payment_step.input_code)||(this.payment_step.input_code=""),this.payment_step.input_code===(this.config.payment_bypass_password||"").toString()&&(this.payment_step.input_code="",this.onNextStep()))},async loadSounds(){let e=[...Array.from({length:10},(e,t)=>`_${t+1}.mp3`),"bat_dau_chup.mp3","chup_xong.mp3","xac_nhan_thanh_toan.mp3","tao_thu_vien_anh.mp3"];for(let t of e){let e=t.replace(".mp3","");this.sound_map[e]=new X.Howl({src:[this.$fetch.base.getSoundFileUrl(t)],volume:1})}},playSound(e){!0===this.config?.voice_guide&&this.sound_map[e]&&(X.Howler.stop(),this.sound_map[e].play())},async getAllFrames(){this.frame.loading=!0;try{this.frame.list=(await this.$fetch.base.listFrames()).map(e=>{let t=this.removeUnicode([e.name,e.dpi,e.size].join(" ")).toLowerCase();return{...e,slug:t}})}catch(e){}this.frame.loading=!1},async getCameraList(){this.cameras=await this.$fetch.base.getCameras()},async stopVideoStreamAndTurnOffCamera(){await this.getCameraList(),this.selected_camera&&await this.$fetch.base.stopCamera(this.selected_camera.unique_id),await this.$fetch.base.remoteTuyaCommand({action:"off"})},async genQrCode({data:e,image:t,color:a="#000000",background:n="#ffffff",shape:i="square"}){let l=new(F())({width:800,height:800,type:"svg",shape:i,data:e,image:t,margin:30,dotsOptions:{color:a,type:"rounded"},backgroundOptions:{color:n},imageOptions:{crossOrigin:"anonymous",margin:10}});return l.getRawData("png").then(e=>URL.createObjectURL(e))},async getDeviceConfig(){let e=await this.$fetch.base.getConfig();try{if(e.license&&(this.config=e,this.config?.auto_swipe&&(this.is_flipping=!0),this.config?.server&&(this.$fetch.server=new D({server:this.config.server})),(()=>{this.loadSounds()})(),this.callback_load_config_complete&&this.callback_load_config_complete(),!1!==this.config?.license?.license_expired))throw new Error("License expired")}catch(t){console.log("Error getDeviceConfig",t),this.directToNoLicense()}},directToNoLicense(){this.$router.push({path:"/no_license",query:{device_id:this.device_id,port:this.$route.query.port||6696}})},onNextStep(){let e=this.step_list.indexOf(this.step);e<this.step_list.length-1&&(this.step=this.step_list[e+1])},onPrevStep(){let e=this.step_list.indexOf(this.step);e>0&&(this.step=this.step_list[e-1])},confirmSelectedQuantity(){this.onNextStep()},capturePhoto(e){const t=this.$refs.video,a=document.createElement("canvas");a.width=t.videoWidth,a.height=t.videoHeight,a.getContext("2d").drawImage(t,0,0,a.width,a.height);a.toDataURL("image/png")},genPaymentOrderId(){if(this.config.fixed_qr_code)return this.config.fixed_qr_order_id||"MAY01FIXEDCODE";let e=this.config.payment_prefix||"MAY01",t=new Date,a=t.getTime().toString(16).toUpperCase(),n=Math.random().toString(36).substring(2,6).toUpperCase();return`${e}${a}${n}`.toUpperCase()},cameraChecking(){return new Promise(async e=>{for(;;){if(this.selected_camera){e(!0);break}this.$AF.$msgWarning("Không có camera được chọn!"),await this.sleep(3e3),await this.getCameraList()}})},requestCapturePhoto({flip:e=!1}){return new Promise(async t=>{this.photos.length>=this.max_temp_photo?(this.photos.splice(0,this.photos.length-this.config.image_temp_max+1),t(!0)):this.cameraChecking().then(a=>{let n=this.$fetch.base.getCameraSnapshotUrl(this.selected_camera.unique_id)+"?flip="+e;return fetch(n).then(e=>e.blob()).then(e=>{const a=URL.createObjectURL(e);this.photos.push({url:a,blob:e}),this.photos.length>this.config.image_temp_max&&this.photos.splice(0,this.photos.length-this.config.image_temp_max),t(a)})})})},async autoCaptureCountdown(){if(this.photos.length>=this.config.image_temp_max)return await this.stopVideoStreamAndTurnOffCamera(),this.onNextStep();this.countdown=this.config.image_auto_capture_in_seconds||5,0===this.photos.length&&(this.countdown+=5),this.playSound("bat_dau_chup"),await this.sleep(1500),this.playSound(`_${this.countdown}`);let e=setInterval(async()=>{if(this.countdown--,this.playSound(`_${this.countdown}`),1===this.countdown){let e=await this.requestCapturePhoto({flip:this.is_flipping});if(0!==e)return this.autoCaptureCountdown()}this.countdown<=0&&clearInterval(e)},1e3)},async getCameraStreamURL(){return this.config.tuya_device_id&&await this.$fetch.base.remoteTuyaCommand({action:"on"}),this.streamUrl=`${this.$fetch.base.base_url}/cameras/stream?quality=${this.config.stream_quality_percent||100}`,this.config.lut_stream&&this.config.lut_default&&(this.streamUrl+=`&lut_path=${this.config.lut_default}`),this.streamUrl},async makeLibrary({pageConfig:e,imageUrls:t}){let a=t.map(e=>e.blob);this.playSound("tao_thu_vien_anh");let n=(await Promise.all([...t.map(e=>this.$fetch.server.anonymousUploadFile({file:e.blob}))])).map(e=>e?.data?.file_id),i=await this.$fetch.base.getLUTs();if(1===i.length&&(this.selected_lut_file=i[0].file),this.selected_lut_file){let e=[];for(let n of t){let t=await this.$fetch.base.applyLUTToImage({imageFile:n.blob,lutFile:this.selected_lut_file});e.push(t)}let a=[];for(let t of e)a.push({url:URL.createObjectURL(t),blob:t});t=a}let l=await this.$fetch.server.anonymousLibraryCreate({image_ids:n}),s="private";l.data&&(l=l.data),l._id&&(s=`https://ptbooth.github.io/lib/?_id=${l._id}&pwd=${l.pwd}`);let o=e=>{try{if(!l._id)return;(async()=>{let t=await this.$fetch.server.anonymousUploadFile({file:e});t?.data?.file_id&&await this.$fetch.server.anonymousLibraryAppendImage({library_id:l._id,image_id:t.data.file_id,pwd:l.pwd})})()}catch(t){}},r=await V({pageConfig:e,imageUrls:t,qrCodeUrl:await this.genQrCode({data:s,image:this.config.payment_qr_logo,color:this.config.payment_qr_color,background:this.config.payment_qr_background,shape:this.config.payment_qr_shape})});r.blob&&(a.push(r.blob),await this.$fetch.base.uploadImagesToStorage({files:a}),o(r.blob),await this.$fetch.base.printImage({printer_id:e.printer_id||this.config.printer_id||this.config.printer_name,imageFile:r.blob,printer_setting:{...this.config.printer_setting||{},...e.printer_setting||{}},copies:this.selected_package?.count||1}),this.playSound("chup_xong"),await this.sleep(5e3),this.$router.go(0))},async getLastTransaction(){let e=await this.$fetch.server.anonymousGetTransactions({api_key:this.config.payment_token_check});this.payment_step.transactions=e.data||[]},genQrForPayment(){return this.payment_order_id=this.genPaymentOrderId(),this.genQrCode({data:W.generateQRData({accountName:this.config.payment_account_name||"Người dùng",accountNumber:this.config.payment_account_number,amount:this.selected_package?.price||0,bankCode:this.config.payment_bank_id,transactionMessage:this.payment_order_id}),image:this.config.payment_qr_logo,color:this.config.payment_qr_color,background:this.config.payment_qr_background,shape:this.config.payment_qr_shape})},startCheckPaymentStatus(){this.config.payment_token_check&&(this.payment_step.interval&&clearInterval(this.payment_step.interval),this.payment_step.interval=setInterval(async()=>{if("payment"!==this.step)return this.payment_step.interval&&clearInterval(this.payment_step.interval),0;await this.getLastTransaction();let e=this.valid_transactions.length>0;if(this.config.fixed_qr_code){let t=this.valid_transactions[0]?.id||"";e=t!==this.payment_step.last_trans_id}e&&(this.playSound("xac_nhan_thanh_toan"),await this.sleep(2e3),this.onNextStep())},5e3))}}},R=a(4232);const P={class:"start-quantity"},q={style:{color:"white"}};function O(e,t,a,l,s,o){const r=(0,i.g2)("n-flex"),c=(0,i.g2)("n-button"),d=(0,i.g2)("Icon"),h=(0,i.g2)("n-collapse-transition");return(0,i.uX)(),(0,i.CE)("div",P,[(0,i.bF)(r,null,{default:(0,i.k6)(()=>[(0,i.bF)(r,{class:"image",style:{flex:"1"},justify:"center",align:"center"},{default:(0,i.k6)(()=>[...t[1]||(t[1]=[(0,i.Lk)("img",{src:"https://m.media-amazon.com/images/I/81b5jXEW+vL.jpg",alt:""},null,-1)])]),_:1}),(0,i.bF)(r,{class:"content",style:{flex:"1"},justify:"center",align:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[t[2]||(t[2]=(0,i.Lk)("h1",null,"Chọn số lượng ảnh muốn chụp",-1)),t[3]||(t[3]=(0,i.Lk)("div",{class:"secondary-text"},"Pick the number of photos you want to take",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o._package_groups,e=>((0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(r,{class:"number-options",justify:"center",align:"center",style:{"margin-top":"16px","flex-wrap":"wrap"}},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.items,e=>((0,i.uX)(),(0,i.Wv)(c,{key:e,size:"large",style:{margin:"8px"},type:"success",onClick:t=>o.setSelectedPackage(e)},{default:(0,i.k6)(()=>[(0,i.eW)((0,R.v_)(e.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]))),256)),(0,i.bo)((0,i.bF)(h,null,{default:(0,i.k6)(()=>[(0,i.bF)(r,{justify:"center",align:"center",style:{"flex-direction":"column","margin-top":"32px"}},{default:(0,i.k6)(()=>[e.$parent.selected_package?.price?((0,i.uX)(),(0,i.Wv)(c,{key:0,style:{"margin-top":"24px"},strong:"",round:"",size:"large",type:"info",secondary:"",onClick:t[0]||(t[0]=t=>e.$parent.onNextStep())},{icon:(0,i.k6)(()=>[(0,i.bF)(d,{icon:"solar:wallet-money-bold-duotone"})]),default:(0,i.k6)(()=>[(0,i.Lk)("span",q,"Thanh toán "+(0,R.v_)(e.$parent.selected_package?.price/1e3)+"K",1)]),_:1})):(0,i.Q3)("",!0)]),_:1})]),_:1},512),[[n.aG,e.$parent.selected_package?.price]])])]),_:1})]),_:1})])}var N={name:"component__start-quantity",props:{},data(){return{}},computed:{_package_groups(){return this.$parent?.config?.packages??[]}},beforeMount(){this._package_groups.length===1**this._package_groups[0].items.length===1&&(this.$parent.selected_package=this._package_groups[0].items[0],this.$parent.onNextStep())},methods:{setSelectedPackage(e){this.$parent.selected_package=e}}};const Q=(0,b.A)(N,[["render",O]]);var B=Q;const K={class:"component__start-payment"},G=["src"];function H(e,t,a,n,l,s){const o=(0,i.g2)("component__photo-back"),r=(0,i.g2)("n-flex");return(0,i.uX)(),(0,i.CE)("div",K,[(0,i.bF)(o),(0,i.bF)(r,{justify:"center",align:"center",style:{"min-height":"100vh"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[t[0]||(t[0]=(0,i.Lk)("h1",null,"Quét mã QR để thanh toán",-1)),t[1]||(t[1]=(0,i.Lk)("div",{class:"secondary-text"},"Scan QR code to pay",-1)),(0,i.Lk)("div",null,[l.qr_code_url?((0,i.uX)(),(0,i.CE)("img",{key:0,src:l.qr_code_url,alt:"QR Code",style:{"margin-top":"24px",width:"300px",height:"300px"}},null,8,G)):(0,i.Q3)("",!0)])])]),_:1})])}const J={class:"photo-booth__back animated fadeInLeft"};function Y(e,t,a,n,l,s){const o=(0,i.g2)("n-flex");return(0,i.uX)(),(0,i.CE)("div",J,[(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.onBack&&s.onBack(...e))},[(0,i.bF)(o,null,{default:(0,i.k6)(()=>[...t[1]||(t[1]=[(0,i.Lk)("span",null,"Quay lại",-1)])]),_:1})])])}var Z={name:"component__photo-back",data(){return{}},methods:{onBack(){window.photoController.onPrevStep()}}};const ee=(0,b.A)(Z,[["render",Y]]);var te=ee,ae={name:"component__start-payment",components:{Component__photoBack:te},data(){return{qr_code_url:""}},computed:{config(){return this.$parent.config}},async beforeMount(){this.qr_code_url=await this.$parent.genQrForPayment()},mounted(){},methods:{test(){this.$parent.onNextStep()}}};const ne=(0,b.A)(ae,[["render",H]]);var ie=ne;const le={class:"start__capture"},se={style:{width:"100%"}},oe={style:{width:"100%","padding-top":"5vh"}},re={class:"image-counter"},ce={class:"camera-canvas"},de=["src"],he={class:"countdown"},ue={key:1,style:{"text-align":"center",color:"white","font-size":"18px","font-weight":"800"}};function pe(e,t,a,n,l,s){const o=(0,i.g2)("n-flex"),r=(0,i.g2)("n-scrollbar"),c=(0,i.g2)("n-col"),d=(0,i.g2)("n-button"),h=(0,i.g2)("Icon"),u=(0,i.g2)("n-progress"),p=(0,i.g2)("n-row");return(0,i.uX)(),(0,i.CE)("div",le,[(0,i.bF)(p,null,{default:(0,i.k6)(()=>[(0,i.bF)(c,{span:6},{default:(0,i.k6)(()=>[(0,i.bF)(r,{align:"center",style:{height:"100vh"},justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",se,[(0,i.Lk)("div",oe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Array.from({length:s.config.image_temp_max},(e,t)=>t),t=>((0,i.uX)(),(0,i.CE)("div",{class:"image",style:(0,R.Tr)({backgroundImage:`url('${(e.$parent.photos[t]||{}).url}')`})},null,4))),256))]),(0,i.bF)(o,{align:"center",justify:"center",style:{"margin-top":"32px"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",re,(0,R.v_)(e.$parent.photos.length)+"/"+(0,R.v_)(s.config.image_temp_max)+" ảnh",1)]),_:1})])]),_:1})]),_:1}),(0,i.bF)(c,{span:18},{default:(0,i.k6)(()=>[(0,i.Lk)("div",ce,[(0,i.bF)(d,{class:"btn-flip",onClick:t[0]||(t[0]=t=>e.$parent.is_flipping=!e.$parent.is_flipping)},{default:(0,i.k6)(()=>[...t[1]||(t[1]=[(0,i.eW)("Xoay camera",-1)])]),_:1}),(0,i.Lk)("img",{alt:"1234",ref:"video",class:(0,R.C4)({flipping:e.$parent.is_flipping}),src:l.streamUrl||"/img/find.jpg",style:{width:"100%",height:"100vh","object-fit":"contain"}},null,10,de),t[2]||(t[2]=(0,i.Lk)("div",{class:"camera-overlay-left"},null,-1)),t[3]||(t[3]=(0,i.Lk)("div",{class:"camera-overlay-right"},null,-1)),(0,i.Lk)("div",he,[(0,i.bF)(u,{style:{width:"70px",margin:"0 8px 12px 0"},type:"multiple-circle","stroke-width":16,"circle-gap":1,"border-radius":"12px 0 12px 0","fill-border-radius":"12px 0 12px 0",percentage:[s.countdown/(s.config.image_auto_capture_in_seconds||5)*100],color:[{stops:["rgb(253,6,167)","#f80472"]}],"rail-color":["rgba(255,255,255,.1)","rgba(255,255,255,.1)"]},{default:(0,i.k6)(()=>[0===s.countdown?((0,i.uX)(),(0,i.Wv)(h,{key:0,icon:"solar:face-scan-circle-bold",color:"white",height:"32"})):((0,i.uX)(),(0,i.CE)("span",ue,(0,R.v_)(s.countdown),1))]),_:1},8,["percentage"])])])]),_:1})]),_:1})])}var ge={name:"component__start-capture",props:{},data(){return{is_flipping:!1,streamUrl:""}},computed:{config(){return this.$parent?.config||{}},countdown(){return this.$parent?.countdown||0}},watch:{"$parent.photos"(e){e.length>=this.config.image_temp_max&&this.$parent.onNextStep()}},mounted(){(async()=>{this.streamUrl=await this.$parent.getCameraStreamURL()})(),this.config.image_auto_capture_in_seconds&&this.$parent.autoCaptureCountdown()},methods:{}};const _e=(0,b.A)(ge,[["render",pe]]);var me=_e;const fe={class:"start-image-picker"},be={class:"image-list__container"},ke=["onClick"],ve={key:0,class:"mark"},ye={class:"preview-form"},we={key:0};function xe(e,t,a,n,l,s){const o=(0,i.g2)("n-flex"),r=(0,i.g2)("n-scrollbar"),c=(0,i.g2)("n-col"),d=(0,i.g2)("Icon"),h=(0,i.g2)("n-button"),u=(0,i.g2)("n-row");return(0,i.uX)(),(0,i.CE)("div",fe,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)(c,{span:10},{default:(0,i.k6)(()=>[(0,i.bF)(r,{class:"scrollbar"},{default:(0,i.k6)(()=>[(0,i.bF)(o,{style:{"min-height":"100vh"},align:"center",justify:"center",direction:"column"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[t[1]||(t[1]=(0,i.Lk)("h1",null,"Chọn hình",-1)),t[2]||(t[2]=(0,i.Lk)("div",{class:"secondary-text"}," Choose images ",-1)),(0,i.bF)(o,{justify:"center",align:"center",style:{"margin-top":"24px"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",be,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.photos,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:(0,R.C4)({image:!0,focused:l.focused_photo_index===t}),onClick:e=>s.addToSelected(t),style:(0,R.Tr)({backgroundImage:`url(${e.url})`})},[s.getIndexSelected(t)>=0?((0,i.uX)(),(0,i.CE)("span",ve,(0,R.v_)(s.getIndexSelected(t)+1),1)):(0,i.Q3)("",!0)],14,ke))),256))])]),_:1}),t[3]||(t[3]=(0,i.Lk)("div",{style:{"margin-top":"32px","text-align":"center"}},[(0,i.Lk)("div",{class:"secondary-text",style:{"font-size":"14px"}}," Nhấn chọn hình để tiếp tục ")],-1))])]),_:1})]),_:1})]),_:1}),(0,i.bF)(c,{span:14},{default:(0,i.k6)(()=>[(0,i.bF)(r,{class:"scrollbar",style:{"background-color":"unset"}},{default:(0,i.k6)(()=>[(0,i.bF)(o,{style:{"min-height":"100vh"},align:"center",justify:"center",direction:"column"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[t[8]||(t[8]=(0,i.Lk)("div",{class:"secondary-text",style:{"font-size":"15px"}}," Nhấn vào các hình đã chụp theo thứ tự ",-1)),(0,i.Lk)("div",ye,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Array.from({length:e.$parent.config.image_max},(e,t)=>t),e=>((0,i.uX)(),(0,i.CE)("div",{class:"preview-item",style:(0,R.Tr)({backgroundImage:void 0!==l.selected_indexes[e]?`url(${l.photos[l.selected_indexes[e]].url})`:"none"})},[void 0===l.selected_indexes[e]?((0,i.uX)(),(0,i.CE)("div",we,(0,R.v_)(e),1)):(0,i.Q3)("",!0)],4))),256))]),(0,i.bF)(o,{style:{"margin-top":"42px"},justify:"space-between",align:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(h,{onClick:t[0]||(t[0]=e=>{l.selected_indexes=[]}),type:"warning",dashed:"",size:"large"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{icon:"solar:refresh-bold-duotone"}),t[4]||(t[4]=(0,i.eW)("   ",-1)),t[5]||(t[5]=(0,i.Lk)("span",null,"Làm lại",-1))]),_:1}),(0,i.bF)(h,{type:"success",size:"large",disabled:l.selected_indexes.length<4,onClick:s.toFilterAndEffect},{default:(0,i.k6)(()=>[t[6]||(t[6]=(0,i.Lk)("span",null,"Tiếp tục",-1)),t[7]||(t[7]=(0,i.eW)("   ",-1)),(0,i.bF)(d,{icon:"solar:alt-arrow-right-bold-duotone"})]),_:1},8,["disabled","onClick"])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})])}var Fe={name:"component__start-image-pick",data(){return{photos:[],focused_photo_index:-1,selected_indexes:[]}},beforeMount(){this.photos=this.$parent.photos},methods:{async toFilterAndEffect(){let e=this.$parent.frame.list[0];this.$parent.makeLibrary({pageConfig:e,imageUrls:this.selected_indexes.map(e=>this.photos[e])})},getIndexSelected(e){return this.selected_indexes.indexOf(e)},addToSelected(e){this.selected_indexes.length>=4||(this.focused_photo_index=e,this.selected_indexes.includes(e)||this.selected_indexes.push(e))}}};const Ce=(0,b.A)(Fe,[["render",xe]]);var Le=Ce;const $e={class:"start-filter-effect"};function Ee(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",$e," filter ")}var Se={name:"component__start-filter-effect",data(){return{}}};const Te=(0,b.A)(Se,[["render",Ee]]);var Ue=Te;const ze={class:"start-share"};function Me(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",ze," This is share ")}var Ae={name:"component__start-share",data(){return{}}};const Ie=(0,b.A)(Ae,[["render",Me]]);var Ve=Ie,De={name:"page__start",mixins:[j],components:{Component__startShare:Ve,Component__startFilterEffect:Ue,Component__startImagePick:Le,Component__startCapture:me,Component__startPayment:ie,Component__startQuantity:B,Component__startSplash:v},data(){return{get_config_count:0,combinedResult:null}},computed:{},watch:{get_config_count:function(e){1===e&&this.stopVideoStreamAndTurnOffCamera()}},beforeMount(){window.photoController=this,this.callback_load_config_complete=()=>{this.get_config_count++},this.getAllFrames()},mounted(){},beforeDestroy(){},methods:{}};const Xe=(0,b.A)(De,[["render",g]]);var We=Xe;const je={style:{"text-align":"left","max-width":"500px",width:"100%",padding:"24px"}},Re={style:{flex:"1"}};function Pe(e,t,a,n,l,s){const o=(0,i.g2)("n-input"),r=(0,i.g2)("Icon"),c=(0,i.g2)("n-button"),d=(0,i.g2)("n-flex"),h=(0,i.g2)("n-scrollbar");return(0,i.uX)(),(0,i.Wv)(h,{class:"no-license-page"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{justify:"center",align:"center",style:{height:"100%"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",je,[t[0]||(t[0]=(0,i.Lk)("div",{class:"why"},"Tại sao tôi thấy màn hình này?",-1)),t[1]||(t[1]=(0,i.Lk)("div",{class:"desc"}," Nếu bạn nhìn thấy màn hình này, rất có thể thiết bị của bạn chưa được cấp phép sử dụng phần mềm. Vui lòng liên hệ với bộ phận hỗ trợ của chúng tôi để được hướng dẫn cấp phép sử dụng. ",-1)),t[2]||(t[2]=(0,i.Lk)("p",{class:"field-label",style:{"margin-top":"32px"}},"Mã thiết bị",-1)),(0,i.Lk)("div",null,[(0,i.bF)(d,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",Re,[(0,i.bF)(o,{type:"text",value:e.device_id,readonly:""},null,8,["value"])]),(0,i.bF)(c,{type:"success",onClick:s.copyDeviceId},{default:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:copy-bold-duotone"})]),_:1},8,["onClick"])]),_:1})]),t[3]||(t[3]=(0,i.Lk)("p",{class:"field-label"}," QR Zalo liên hệ ",-1)),t[4]||(t[4]=(0,i.Lk)("div",null,[(0,i.Lk)("img",{src:"/img/dev_zalo.png",alt:"Zalo QR",width:"200"})],-1)),t[5]||(t[5]=(0,i.Lk)("p",{class:"field-label"},"Số điện thoại",-1)),(0,i.bF)(o,{value:"0367036699"}),t[6]||(t[6]=(0,i.Lk)("p",{class:"field-label"}," Hoặc liên hệ qua email ",-1)),(0,i.bF)(o,{value:"vuducminhp@gmail.com"})])]),_:1})]),_:1})}var qe={mixins:[j],name:"page__no-license",data(){return{}},beforeMount(){this.callback_load_config_complete=e=>{!1===this.config?.license?.license_expired&&this.$router.push({path:"/setting",query:{...this.$route.query,from:this.$route.path}})}},mounted(){},methods:{copyDeviceId(){navigator.clipboard.writeText(this.device_id),this.$AF.$msgSuccess("Đã sao chép mã thiết bị")}}};const Oe=(0,b.A)(qe,[["render",Pe]]);var Ne=Oe;const Qe={style:{"text-align":"left","max-width":"860px",width:"100%",padding:"24px"}},Be={style:{flex:"1"}},Ke={style:{flex:"1"}},Ge={style:{"padding-top":"10px"}},He={style:{flex:"1"}},Je={class:"lut-item"},Ye={style:{flex:"1"}},Ze={style:{flex:"1"}},et={style:{padding:"12px 20px","margin-top":"12px","border-left":"1px dashed rgb(200,200,200)"}},tt={style:{flex:"1"}},at={key:0,class:"field-label"},nt={style:{flex:"1"}},it={key:0,class:"field-label"},lt={style:{flex:"1"}},st={key:0,class:"field-label"},ot={key:0,class:"field-label"},rt={style:{"margin-top":"8px"}},ct={style:{"margin-top":"20px"}},dt={style:{flex:"1"}},ht={style:{"max-width":"860px",width:"100%",padding:"0 24px"}};function ut(e,t,a,n,l,s){const o=(0,i.g2)("Icon"),r=(0,i.g2)("n-button"),c=(0,i.g2)("n-flex"),d=(0,i.g2)("n-input"),h=(0,i.g2)("n-alert"),u=(0,i.g2)("n-select"),p=(0,i.g2)("component__input-number"),g=(0,i.g2)("n-col"),_=(0,i.g2)("n-slider"),m=(0,i.g2)("n-switch"),f=(0,i.g2)("n-row"),b=(0,i.g2)("component__printer-setting"),k=(0,i.g2)("n-collapse-item"),v=(0,i.g2)("n-collapse"),y=(0,i.g2)("n-card"),w=(0,i.g2)("n-tab-pane"),x=(0,i.g2)("n-color-picker"),F=(0,i.g2)("n-image"),C=(0,i.g2)("n-tabs"),L=(0,i.g2)("n-scrollbar"),$=(0,i.g2)("component__modal-content"),E=(0,i.g2)("n-modal");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(L,{class:"setting-page",style:{height:"calc(100vh - 66px)",width:"100%"}},{default:(0,i.k6)(()=>[(0,i.bF)(c,{justify:"center",align:"top"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",Qe,[(0,i.bF)(c,{align:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(r,{onClick:s.goBack,tertiary:""},{default:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:arrow-left-broken"})]),_:1},8,["onClick"]),t[34]||(t[34]=(0,i.Lk)("div",{class:"why"},"Cài đặt",-1))]),_:1}),t[98]||(t[98]=(0,i.Lk)("div",{class:"desc"}," Từ đây bạn có thể thay đổi các thiết lập như gói, số lượng ảnh, chất lượng ảnh, thanh toán, ... ",-1)),(0,i.bF)(C,{style:{"margin-top":"32px"},animated:"",placement:"left",type:"card"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{name:"camera",tab:"Máy ảnh & Máy in"},{default:(0,i.k6)(()=>[t[51]||(t[51]=(0,i.Lk)("p",{class:"field-label"},"Mã thiết bị",-1)),(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",Be,[(0,i.bF)(d,{type:"text",value:e.device_id,readonly:""},null,8,["value"])]),(0,i.bF)(r,{onClick:s.copyDeviceId},{default:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:copy-bold-duotone"})]),_:1},8,["onClick"])]),_:1}),(0,i.Lk)("div",null,[e.license_expire_soon?((0,i.uX)(),(0,i.Wv)(h,{key:0,style:{"margin-top":"12px"},type:"warning"},{default:(0,i.k6)(()=>[(0,i.eW)(" Bản quyền của bạn sắp hết hạn, vui lòng gia hạn để tiếp tục sử dụng ("+(0,R.v_)(new Date(1e3*e.config?.license?.license_to).toLocaleString())+") ",1)]),_:1})):((0,i.uX)(),(0,i.Wv)(h,{key:1,type:"success",style:{"margin-top":"12px"}},{default:(0,i.k6)(()=>[(0,i.eW)(" Bản quyền của bạn còn hạn đến "+(0,R.v_)(new Date(1e3*e.config?.license?.license_to).toLocaleString()),1)]),_:1}))]),t[52]||(t[52]=(0,i.Lk)("p",{class:"field-label"},"Máy ảnh / Camera",-1)),(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",Ke,[(0,i.bF)(u,{value:e.config.camera_unique_id,"onUpdate:value":t[0]||(t[0]=t=>e.config.camera_unique_id=t),filterable:"",options:l.camera.list.map(e=>({label:e.name,value:e.unique_id}))},null,8,["value","options"])]),(0,i.bF)(r,{onClick:s.getCameras,loading:l.camera.loading},{icon:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:refresh-line-duotone"})]),_:1},8,["onClick","loading"])]),_:1}),(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[35]||(t[35]=(0,i.Lk)("p",{class:"field-label"},"Số lần chụp",-1)),(0,i.bF)(p,{"model-value":e.config.image_temp_max,"onUpdate:modelValue":t[1]||(t[1]=t=>e.config.image_temp_max=t),placeholder:"Nhập số lượng ảnh"},null,8,["model-value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[36]||(t[36]=(0,i.Lk)("p",{class:"field-label"},"Số lượng ảnh",-1)),(0,i.bF)(p,{"model-value":e.config.image_max,"onUpdate:modelValue":t[2]||(t[2]=t=>e.config.image_max=t),placeholder:"Nhập số lượng ảnh"},null,8,["model-value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[37]||(t[37]=(0,i.Lk)("p",{class:"field-label"},"Số giây chờ (Tự chụp nếu hết giờ)",-1)),(0,i.bF)(p,{"model-value":e.config.image_auto_capture_in_seconds,"onUpdate:modelValue":t[3]||(t[3]=t=>e.config.image_auto_capture_in_seconds=t),placeholder:"Nhập số giây"},null,8,["model-value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[38]||(t[38]=(0,i.Lk)("p",{class:"field-label"},"Chất lượng Stream (%)",-1)),(0,i.Lk)("div",Ge,[(0,i.bF)(_,{min:2,max:100,value:e.config.stream_quality_percent,"onUpdate:value":t[4]||(t[4]=t=>e.config.stream_quality_percent=t),step:1},null,8,["value"])])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[41]||(t[41]=(0,i.Lk)("p",{class:"field-label"},"Xoay ngang ảnh (Lật ảnh Trái - Phải)",-1)),(0,i.bF)(m,{value:e.config.auto_swipe,"onUpdate:value":t[5]||(t[5]=t=>e.config.auto_swipe=t)},{checked:(0,i.k6)(()=>[...t[39]||(t[39]=[(0,i.eW)("Mở",-1)])]),unchecked:(0,i.k6)(()=>[...t[40]||(t[40]=[(0,i.eW)("Tắt",-1)])]),_:1},8,["value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[44]||(t[44]=(0,i.Lk)("p",{class:"field-label"},"Âm thanh hướng dẫn",-1)),(0,i.bF)(m,{value:e.config.voice_guide,"onUpdate:value":t[6]||(t[6]=t=>e.config.voice_guide=t)},{checked:(0,i.k6)(()=>[...t[42]||(t[42]=[(0,i.eW)("Mở",-1)])]),unchecked:(0,i.k6)(()=>[...t[43]||(t[43]=[(0,i.eW)("Tắt",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t[53]||(t[53]=(0,i.Lk)("hr",null,null,-1)),t[54]||(t[54]=(0,i.Lk)("p",{class:"group-label"},"Máy in",-1)),t[55]||(t[55]=(0,i.Lk)("p",{class:"field-label"},"Mặc định",-1)),(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",He,[(0,i.bF)(u,{value:e.config.printer_id,"onUpdate:value":t[7]||(t[7]=t=>e.config.printer_id=t),filterable:"",options:l.printer.list.map(e=>({label:e.name,value:e.id}))},null,8,["value","options"])]),(0,i.bF)(r,{onClick:s.getPrinters,loading:l.printer.loading},{icon:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:refresh-line-duotone"})]),_:1},8,["onClick","loading"])]),_:1}),e.config.printer_id?((0,i.uX)(),(0,i.Wv)(y,{key:0,style:{"margin-top":"18px"}},{default:(0,i.k6)(()=>[(0,i.bF)(v,{accordion:""},{default:(0,i.k6)(()=>[(0,i.bF)(k,{title:"Cài đặt máy in nâng cao",name:"printer_setting"},{default:(0,i.k6)(()=>[(0,i.bF)(b,{printer_id:e.config.printer_id,current_setting:e.config.printer_setting,"onUpdate:current_setting":t[8]||(t[8]=t=>e.config.printer_setting=t)},null,8,["printer_id","current_setting"])]),_:1})]),_:1})]),_:1})):(0,i.Q3)("",!0),t[56]||(t[56]=(0,i.Lk)("hr",null,null,-1)),t[57]||(t[57]=(0,i.Lk)("p",{class:"group-label"},"LUT",-1)),t[58]||(t[58]=(0,i.Lk)("p",{class:"field-label"},"Danh sách bộ lọc",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.lut.list,e=>((0,i.uX)(),(0,i.CE)("div",Je,[(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",Ye,(0,R.v_)(e.name),1),(0,i.bF)(r,{size:"tiny",onClick:t=>s.initialDeleteLUT(e)},{default:(0,i.k6)(()=>[...t[45]||(t[45]=[(0,i.eW)("Xóa",-1)])]),_:1},8,["onClick"])]),_:2},1024)]))),256)),(0,i.bF)(r,{size:"small",onClick:t[10]||(t[10]=t=>e.$refs.input_lut_file.click()),style:{"margin-top":"12px"}},{icon:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:cloud-upload-broken"})]),default:(0,i.k6)(()=>[(0,i.Lk)("input",{type:"file",style:{display:"none"},ref:"input_lut_file",onChange:t[9]||(t[9]=(...e)=>s.handleLutFileChange&&s.handleLutFileChange(...e)),pattern:"*.cube"},null,544),t[46]||(t[46]=(0,i.eW)(" Thêm bộ lọc (.cube) ",-1))]),_:1}),(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[49]||(t[49]=(0,i.Lk)("p",{class:"field-label"},"Áp dụng LUT lên Stream",-1)),(0,i.bF)(m,{value:e.config.lut_stream,"onUpdate:value":t[11]||(t[11]=t=>e.config.lut_stream=t)},{checked:(0,i.k6)(()=>[...t[47]||(t[47]=[(0,i.eW)("Mở",-1)])]),unchecked:(0,i.k6)(()=>[...t[48]||(t[48]=[(0,i.eW)("Tắt",-1)])]),_:1},8,["value"])]),_:1}),e.config.lut_stream?((0,i.uX)(),(0,i.Wv)(g,{key:0,span:12},{default:(0,i.k6)(()=>[t[50]||(t[50]=(0,i.Lk)("p",{class:"field-label"},"Chọn hiệu ứng",-1)),(0,i.bF)(u,{value:e.config.lut_default,"onUpdate:value":t[12]||(t[12]=t=>e.config.lut_default=t),filterable:"",options:l.lut.list.map(e=>({label:e.name,value:e.file}))},null,8,["value","options"])]),_:1})):(0,i.Q3)("",!0)]),_:1}),t[59]||(t[59]=(0,i.Lk)("div",{style:{height:"40px"}},null,-1))]),_:1}),(0,i.bF)(w,{name:"package",tab:"Gói & Giá gói"},{default:(0,i.k6)(()=>[(0,i.bF)(c,{justify:"end",style:{"padding-bottom":"12px"}},{default:(0,i.k6)(()=>[(0,i.bF)(r,{size:"tiny",onClick:t[13]||(t[13]=t=>e.$router.push({path:"/setting/frame",query:e.$route.query||{}}))},{default:(0,i.k6)(()=>[...t[60]||(t[60]=[(0,i.eW)("Quản lí khung ",-1)])]),_:1})]),_:1}),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.config.packages,(e,a)=>((0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",Ze,[t[61]||(t[61]=(0,i.Lk)("p",{class:"field-label"},"Tên nhóm",-1)),(0,i.bF)(d,{type:"text",value:e.name,"onUpdate:value":t=>e.name=t,placeholder:"Nhập tên nhóm"},null,8,["value","onUpdate:value"])]),(0,i.Lk)("div",null,[t[62]||(t[62]=(0,i.Lk)("p",{class:"field-label"}," ",-1)),(0,i.bF)(r,{onClick:e=>s.initialDeletePackageGroup(a)},{icon:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:trash-bin-2-broken"})]),_:1},8,["onClick"])])]),_:2},1024),t[64]||(t[64]=(0,i.Lk)("p",{class:"field-label"},"Ảnh nhóm gói",-1)),(0,i.bF)(d,{type:"text",value:e.image,"onUpdate:value":t=>e.image=t,placeholder:"Nhập URL ảnh nhóm gói"},null,8,["value","onUpdate:value"]),(0,i.Lk)("div",et,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.items,(t,a)=>((0,i.uX)(),(0,i.Wv)(c,{style:{"margin-bottom":"4px"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",tt,[0===a?((0,i.uX)(),(0,i.CE)("p",at,"Tên gói")):(0,i.Q3)("",!0),(0,i.bF)(d,{type:"text",value:t.name,"onUpdate:value":e=>t.name=e,placeholder:"Nhập tên gói"},null,8,["value","onUpdate:value"])]),(0,i.Lk)("div",nt,[0===a?((0,i.uX)(),(0,i.CE)("p",it,"Giá gói (VNĐ)")):(0,i.Q3)("",!0),(0,i.bF)(p,{"model-value":t.price,"onUpdate:modelValue":e=>t.price=e,max:1e7,step:5e3,placeholder:"Nhập giá gói"},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Lk)("div",lt,[0===a?((0,i.uX)(),(0,i.CE)("p",st,"Số lượng ảnh")):(0,i.Q3)("",!0),(0,i.bF)(p,{"model-value":t.count,"onUpdate:modelValue":e=>t.count=e,max:20,step:1,placeholder:"Nhập số lượng ảnh"},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Lk)("div",null,[0===a?((0,i.uX)(),(0,i.CE)("p",ot," ")):(0,i.Q3)("",!0),(0,i.bF)(r,{onClick:t=>e.items.splice(a,1)},{icon:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:trash-bin-2-broken"})]),_:1},8,["onClick"])])]),_:2},1024))),256)),(0,i.Lk)("div",rt,[(0,i.bF)(r,{size:"small",onClick:e=>s.addPackage(a)},{default:(0,i.k6)(()=>[...t[63]||(t[63]=[(0,i.eW)("Thêm gói",-1)])]),_:1},8,["onClick"])])]),t[65]||(t[65]=(0,i.Lk)("hr",null,null,-1))],64))),256)),(0,i.Lk)("div",ct,[(0,i.bF)(r,{size:"small",onClick:s.addGroupPackage},{default:(0,i.k6)(()=>[...t[66]||(t[66]=[(0,i.eW)("Thêm nhóm gói",-1)])]),_:1},8,["onClick"])])]),_:1}),(0,i.bF)(w,{name:"payment",tab:"Thanh toán"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[67]||(t[67]=(0,i.Lk)("p",{class:"field-label"},"Tiền tố thanh toán",-1)),(0,i.bF)(d,{type:"text",value:e.config.payment_prefix,"onUpdate:value":t[14]||(t[14]=t=>e.config.payment_prefix=t),placeholder:"Nhập tiền tố"},null,8,["value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[68]||(t[68]=(0,i.Lk)("p",{class:"field-label"},"Ngân hàng",-1)),(0,i.bF)(u,{filterable:"",value:e.config.payment_bank_id,"onUpdate:value":t[15]||(t[15]=t=>e.config.payment_bank_id=t),options:l.bank.list.map(e=>({label:`${e.shortName} - ${e.name}`,value:e.bin}))},null,8,["value","options"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[69]||(t[69]=(0,i.Lk)("p",{class:"field-label"},"Số tài khoản",-1)),(0,i.bF)(d,{type:"text",value:e.config.payment_account_number,"onUpdate:value":t[16]||(t[16]=t=>e.config.payment_account_number=t),placeholder:"Nhập số tài khoản"},null,8,["value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[70]||(t[70]=(0,i.Lk)("p",{class:"field-label"},"Tên chủ tài khoản (Optional)",-1)),(0,i.bF)(d,{type:"text",value:e.config.payment_account_name,"onUpdate:value":t[17]||(t[17]=t=>e.config.payment_account_name=t),placeholder:"Nhập tên chủ tài khoản"},null,8,["value"])]),_:1})]),_:1}),t[86]||(t[86]=(0,i.Lk)("p",{class:"field-label"},"Mã (Casso/Sepay)",-1)),(0,i.bF)(d,{type:"text",value:e.config.payment_token_check,"onUpdate:value":t[18]||(t[18]=t=>e.config.payment_token_check=t),placeholder:"Nhập token để kiểm tra thanh toán"},null,8,["value"]),e.config.payment_token_check?((0,i.uX)(),(0,i.Wv)(h,{key:0,style:{"margin-top":"20px"},type:"info"},{default:(0,i.k6)(()=>[t[72]||(t[72]=(0,i.eW)(" Bạn sử sử dụng URL cấu hình Webook sau: ",-1)),(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",dt,(0,R.v_)(s._get_webhook_url),1),(0,i.bF)(r,{size:"small",onClick:s.copyWebhookURL},{default:(0,i.k6)(()=>[...t[71]||(t[71]=[(0,i.eW)("Sao chép",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})):(0,i.Q3)("",!0),(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[75]||(t[75]=(0,i.Lk)("p",{class:"field-label"},"Sử dụng QR cố định",-1)),(0,i.bF)(m,{value:e.config.fixed_qr_code,"onUpdate:value":t[19]||(t[19]=t=>e.config.fixed_qr_code=t)},{checked:(0,i.k6)(()=>[...t[73]||(t[73]=[(0,i.eW)("Mở",-1)])]),unchecked:(0,i.k6)(()=>[...t[74]||(t[74]=[(0,i.eW)("Tắt",-1)])]),_:1},8,["value"])]),_:1}),e.config.fixed_qr_code?((0,i.uX)(),(0,i.Wv)(g,{key:0,span:12},{default:(0,i.k6)(()=>[t[76]||(t[76]=(0,i.Lk)("p",{class:"field-label"},"Mã đơn hàng cố định",-1)),(0,i.bF)(d,{type:"text",value:e.config.fixed_qr_order_id,"onUpdate:value":t[20]||(t[20]=t=>e.config.fixed_qr_order_id=t),placeholder:"Nhập URL QR code cố định"},null,8,["value"])]),_:1})):(0,i.Q3)("",!0),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[77]||(t[77]=(0,i.Lk)("p",{class:"field-label"},"Mật khẩu bỏ qua thanh toán",-1)),(0,i.bF)(d,{type:"text",value:e.config.payment_bypass_password,"onUpdate:value":t[21]||(t[21]=t=>e.config.payment_bypass_password=t),placeholder:"Nhập mật khẩu bỏ qua thanh toán"},null,8,["value"])]),_:1})]),_:1}),t[87]||(t[87]=(0,i.Lk)("hr",null,null,-1)),t[88]||(t[88]=(0,i.Lk)("p",{class:"group-label"},"QR tủy chỉnh",-1)),(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[78]||(t[78]=(0,i.Lk)("p",{class:"field-label"},"Logo QR code",-1)),(0,i.bF)(d,{type:"text",value:e.config.payment_qr_logo,"onUpdate:value":t[22]||(t[22]=t=>e.config.payment_qr_logo=t),placeholder:"Nhập URL logo QR code"},null,8,["value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[79]||(t[79]=(0,i.Lk)("p",{class:"field-label"},"Hình QR",-1)),(0,i.bF)(u,{value:e.config.payment_qr_shape,"onUpdate:value":t[23]||(t[23]=t=>e.config.payment_qr_shape=t),filterable:"",onChange:s.genTestOrder,options:[{label:"Vuông",value:"square"},{label:"Tròn",value:"circle"}]},null,8,["value","onChange"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[80]||(t[80]=(0,i.Lk)("p",{class:"field-label"},"Màu nổi",-1)),(0,i.bF)(x,{value:e.config.payment_qr_color,"onUpdate:value":t[24]||(t[24]=t=>e.config.payment_qr_color=t),onComplete:s.genTestOrder,style:{"max-width":"100px"}},null,8,["value","onComplete"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[81]||(t[81]=(0,i.Lk)("p",{class:"field-label"},"Màu nền",-1)),(0,i.bF)(x,{onComplete:s.genTestOrder,value:e.config.payment_qr_background,"onUpdate:value":t[25]||(t[25]=t=>e.config.payment_qr_background=t),style:{"max-width":"100px"}},null,8,["onComplete","value"])]),_:1})]),_:1}),t[89]||(t[89]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:8},{default:(0,i.k6)(()=>[t[83]||(t[83]=(0,i.Lk)("p",{class:"group-label",style:{"margin-top":"0"}},"Tạo thử QR",-1)),t[84]||(t[84]=(0,i.Lk)("p",{class:"field-label"},"Số tiền",-1)),(0,i.bF)(p,{"model-value":l.input_amount,"onUpdate:modelValue":t[26]||(t[26]=e=>l.input_amount=e),min:1e4,step:1e3,max:1e8,placeholder:"Nhập số tiền"},null,8,["model-value"]),t[85]||(t[85]=(0,i.Lk)("p",{class:"field-label"},"Mã đơn hàng",-1)),(0,i.bF)(d,{type:"text",value:e.payment_order_id,"onUpdate:value":t[27]||(t[27]=t=>e.payment_order_id=t),placeholder:"Nhập mã đơn hàng"},null,8,["value"]),(0,i.bF)(r,{size:"small",type:"tertiary",style:{"margin-top":"22px"},onClick:s.genTestOrder},{default:(0,i.k6)(()=>[...t[82]||(t[82]=[(0,i.eW)(" Tạo thử ",-1)])]),_:1},8,["onClick"])]),_:1}),(0,i.bF)(g,{span:16,class:"text-right"},{default:(0,i.k6)(()=>[(0,i.bF)(c,{justify:"end"},{default:(0,i.k6)(()=>[l.preview_qr_url?((0,i.uX)(),(0,i.Wv)(F,{key:0,src:l.preview_qr_url,width:"200px"},null,8,["src"])):(0,i.Q3)("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),(0,i.bF)(w,{name:"tuya",tab:"Công tắc Tuya"},{default:(0,i.k6)(()=>[(0,i.bF)(f,{gutter:16},{default:(0,i.k6)(()=>[(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[90]||(t[90]=(0,i.Lk)("p",{class:"field-label"},"Tuya ID",-1)),(0,i.bF)(d,{type:"text",value:e.config.tuya_device_id,"onUpdate:value":t[28]||(t[28]=t=>e.config.tuya_device_id=t),placeholder:"Nhập ID công tắc"},null,8,["value"])]),_:1}),(0,i.bF)(g,{span:12},{default:(0,i.k6)(()=>[t[91]||(t[91]=(0,i.Lk)("p",{class:"field-label"},"Mật khẩu",-1)),(0,i.bF)(d,{type:"text",value:e.config.tuya_device_id,"onUpdate:value":t[29]||(t[29]=t=>e.config.tuya_device_id=t),placeholder:"Nhập mật mã công tắc"},null,8,["value"])]),_:1}),(0,i.bF)(g,{span:24},{default:(0,i.k6)(()=>[t[92]||(t[92]=(0,i.Lk)("p",{class:"field-label"},"Số phiên bản",-1)),(0,i.bF)(u,{value:e.config.tuya_device_version,"onUpdate:value":t[30]||(t[30]=t=>e.config.tuya_device_version=t),filterable:"",tag:"",options:[{label:"3.2",value:"3.2"},{label:"3.3",value:"3.3"},{label:"3.4",value:"3.4"}]},null,8,["value"])]),_:1})]),_:1})]),_:1}),(0,i.bF)(w,{name:"support",tab:"Hỗ trợ"},{default:(0,i.k6)(()=>[(0,i.bF)(h,{type:"info"},{default:(0,i.k6)(()=>[...t[93]||(t[93]=[(0,i.eW)(" Trong trường hợp bạn cần hỗ trợ hoặc yêu cầu tình năng mới, vui lòng liên hệ với chúng tôi qua các thông tin dưới đây. ",-1)])]),_:1}),t[94]||(t[94]=(0,i.Lk)("p",{class:"field-label"}," QR Zalo liên hệ ",-1)),t[95]||(t[95]=(0,i.Lk)("div",null,[(0,i.Lk)("img",{src:"/img/dev_zalo.png",alt:"Zalo QR",width:"200"})],-1)),t[96]||(t[96]=(0,i.Lk)("p",{class:"field-label"},"Số điện thoại",-1)),(0,i.bF)(d,{value:"0367036699"}),t[97]||(t[97]=(0,i.Lk)("p",{class:"field-label"}," Hoặc liên hệ qua email ",-1)),(0,i.bF)(d,{value:"vuducminhp@gmail.com"})]),_:1})]),_:1})])]),_:1})]),_:1}),(0,i.bF)(c,{style:{padding:"16px 0","background-color":"rgb(63,63,70)"},justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",ht,[(0,i.bF)(c,{justify:"end"},{default:(0,i.k6)(()=>[(0,i.bF)(r,{type:"primary",onClick:s.trySaveDeviceConfig,loading:l.saving},{default:(0,i.k6)(()=>[...t[99]||(t[99]=[(0,i.eW)(" Lưu cài đặt ",-1)])]),_:1},8,["onClick","loading"])]),_:1})])]),_:1}),(0,i.bF)(E,{show:l.lut.upload_file_show,"onUpdate:show":t[33]||(t[33]=e=>l.lut.upload_file_show=e),title:"Xác nhận thêm LUT"},{default:(0,i.k6)(()=>[(0,i.bF)($,{title:"Thêm bộ lọc LUT",onClose:t[32]||(t[32]=e=>l.lut.upload_file_show=!1),onAction:s.onFinalAddLut,action_loading:l.lut.loading},{default:(0,i.k6)(()=>[t[100]||(t[100]=(0,i.Lk)("p",{class:"field-label"},"Tên gợi nhớ cho tệp LUT này",-1)),(0,i.bF)(d,{value:l.lut.upload_file_name,"onUpdate:value":t[31]||(t[31]=e=>l.lut.upload_file_name=e),placeholder:"Nhập tên gợi nhớ"},null,8,["value"])]),_:1},8,["onAction","action_loading"])]),_:1},8,["show"])],64)}const pt={class:"native-input-quantity"};function gt(e,t,a,n,l,s){const o=(0,i.g2)("n-input-number");return(0,i.uX)(),(0,i.CE)("div",pt,[(0,i.bF)(o,{value:l.scopeValue,"onUpdate:value":t[0]||(t[0]=e=>l.scopeValue=e),step:a.step,size:a.size,parse:l.parse,format:l.format},null,8,["value","step","size","parse","format"])])}var _t={name:"component__input-number",props:{modelValue:{type:Number,default:1},max:{type:Number,default:1e4},min:{type:Number,default:1},size:{type:String,default:"medium"},step:{type:Number,default:1}},data(){return{scopeValue:0,parse:e=>{const t=e.replace(/,/g,"").trim();return/^\d+(\.(\d+)?)?$/.test(t)?Number(t):""===t?null:Number.NaN},format:e=>null===e?"":e.toLocaleString("en-US")}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){if(e!==this.modelValue){let t=e;e>this.max&&(t=this.max),e<this.min&&(t=this.min),t!==e&&(this.scopeValue=t),this.$emit("update:modelValue",t)}}},beforeMount(){this.scopeValue=this.modelValue},methods:{sub(){let e=this.scopeValue-1;e<this.min&&(e=this.min),this.scopeValue=e,this.scopeValue!==this.modelValue&&this.$emit("update:modelValue",e)},add(){let e=this.scopeValue+1;e>this.max&&(e=this.max),this.scopeValue=e,this.scopeValue!==this.modelValue&&this.$emit("update:modelValue",e)}}};const mt=(0,b.A)(_t,[["render",gt]]);var ft=mt;const bt={class:(0,R.C4)({"modal-header":!0})},kt={class:"flex-3 title",style:{flex:"1"}},vt={class:"modal-content"},yt={class:"inner-scroll"},wt={class:"modal-footer text-right"},xt={key:1,class:"text-right"};function Ft(e,t,a,n,l,s){const o=(0,i.g2)("Icon"),r=(0,i.g2)("n-flex"),c=(0,i.g2)("n-infinite-scroll"),d=(0,i.g2)("n-button"),h=(0,i.g2)("n-spin");return(0,i.uX)(),(0,i.CE)("div",{class:(0,R.C4)({"model-content__wrapper":!0,"no-padding":a.no_padding,fixed:a.header_fixed}),style:(0,R.Tr)({width:a.width})},[(0,i.Lk)("div",bt,[a.is_custom_header?(0,i.RG)(e.$slots,"header",{key:0}):((0,i.uX)(),(0,i.Wv)(r,{key:1,align:"center",justify:"space-between"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",kt,(0,R.v_)(a.title),1),(0,i.Lk)("button",{class:"btn-header-color",onClick:t[0]||(t[0]=t=>e.$emit("close"))},[(0,i.bF)(o,{icon:"solar:close-circle-bold",height:"20"})])]),_:1}))]),(0,i.Lk)("div",vt,[(0,i.bF)(c,{style:(0,R.Tr)({maxHeight:a.max_height})},{default:(0,i.k6)(()=>[(0,i.Lk)("div",yt,[(0,i.RG)(e.$slots,"default")])]),_:3},8,["style"])]),(0,i.Lk)("div",wt,[a.is_custom_footer?(0,i.RG)(e.$slots,"footer",{key:0}):((0,i.uX)(),(0,i.CE)("div",xt,[a.show_bottom_back_button?((0,i.uX)(),(0,i.Wv)(d,{key:0,onClick:t[1]||(t[1]=t=>e.$emit("close")),type:"default",round:""},{default:(0,i.k6)(()=>[...t[2]||(t[2]=[(0,i.eW)(" Đóng ",-1)])]),_:1})):(0,i.Q3)("",!0),t[4]||(t[4]=(0,i.eW)("   ",-1)),a.action_hide?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(d,{key:1,round:"",type:a.action_type,disabled:a.action_disabled||a.action_loading,onClick:s.emitAction},{default:(0,i.k6)(()=>[a.action_loading?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.bF)(h,{stroke:"white",size:12}),t[3]||(t[3]=(0,i.eW)("   ",-1))],64)):(0,i.Q3)("",!0),(0,i.eW)(" "+(0,R.v_)(a.action_text),1)]),_:1},8,["type","disabled","onClick"]))]))])],6)}var Ct={name:"component__modal-content",components:{Icon:d.In},props:{title:{type:String,default:""},width:{type:String,default:"500px"},no_padding:{type:Boolean,default:!1},hide_header:{type:Boolean,default:!1},is_custom_header:{type:Boolean,default:!1},hide_footer:{type:Boolean,default:!1},is_custom_footer:{type:Boolean,default:!1},action_loading:{type:Boolean,default:!1},action_type:{type:String,default:"primary"},action_text:{type:String,default:"Lưu thông tin"},action_disabled:{type:Boolean,default:!1},action_hide:{type:Boolean,default:!1},max_height:{type:String,default:"calc(100vh - 180px)"},header_fixed:{type:Boolean,default:!1},close_on_click_outside:{type:Boolean,default:!0},show_bottom_back_button:{type:Boolean,default:!0}},data(){return{}},methods:{emitAction(){this.$emit("action")}}};const Lt=(0,b.A)(Ct,[["render",Ft]]);var $t=Lt,Et=a(2462),St=a.n(Et);const Tt={class:"printer-detail"},Ut={class:"field-label"},zt={key:0,style:{background:"rgba(196,194,194,0.66)","border-radius":"50vh",padding:"0 6px",color:"white"}};function Mt(e,t,a,n,l,s){const o=(0,i.g2)("n-select"),r=(0,i.g2)("n-col"),c=(0,i.g2)("n-row");return(0,i.uX)(),(0,i.CE)("div",Tt,[(0,i.bF)(c,{gutter:12},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.allow_edit_keys,e=>((0,i.uX)(),(0,i.Wv)(r,{span:12},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[(0,i.Lk)("p",Ut,[(0,i.eW)((0,R.v_)(e)+" ",1),l.scope_settings[e].current!==l.all_settings?.config?.options?.[e]?.current?((0,i.uX)(),(0,i.CE)("span",zt," Thiết bị: "+(0,R.v_)(l.all_settings?.config?.options?.[e]?.current),1)):(0,i.Q3)("",!0)]),(0,i.bF)(o,{value:l.scope_settings[e].current,"onUpdate:value":t=>l.scope_settings[e].current=t,onChange:s.emitUpdate,options:(l.scope_settings[e].available||[]).map(e=>({label:e,value:e}))},null,8,["value","onUpdate:value","onChange","options"])])]),_:2},1024))),256))]),_:1})])}var At={name:"component__printer-setting",props:{current_setting:{type:Object},printer_id:{type:String,required:!0},is_all:{type:Boolean,default:()=>!0},allow_keys:{type:Array,default:()=>[]}},data(){return{scope_settings:{},all_settings:{loading:!1,config:{}}}},computed:{allow_edit_keys(){return this.is_all?Object.keys(this.scope_settings):Object.keys(this.scope_settings).filter(e=>this.allow_keys.includes(e))}},watch:{printer_id:{immediate:!0,handle(){this.getPrinterSettingDetail()}},scope_settings:{deep:!0,handle(e){}}},beforeMount(){this.scope_settings=this.current_setting||{},this.getPrinterSettingDetail()},methods:{async getPrinterSettingDetail(){this.all_settings.loading=!0;let e=await this.$fetch.base.getPrinterSettings(this.printer_id);this.all_settings.config=e||{},this.scope_settings=JSON.parse(JSON.stringify(e.options||{})),Object.keys(this.current_setting||{}).forEach(e=>{this.scope_settings[e]&&(this.scope_settings[e].current=this.current_setting[e])}),this.all_settings.loading=!1},emitUpdate(){this.$nextTick(()=>{let e={};this.allow_edit_keys.forEach(t=>{e[t]=this.scope_settings[t].current}),this.$emit("update:current_setting",e)})}}};const It=(0,b.A)(At,[["render",Mt]]);var Vt=It,Dt={name:"page__no-license",components:{Component__printerSetting:Vt,Component__settingFrameComponentPrinterSetting:Vt,Component__modalContent:$t,Component__inputNumber:ft},mixins:[j],data(){return{camera:{loading:!1,list:[]},bank:{loading:!1,list:[]},printer:{loading:!1,list:[]},input_amount:1e5,saving:!1,preview_qr_url:"",lut:{loading:!1,list:[],upload_file:null,upload_file_name:"",upload_file_show:!1}}},computed:{_get_webhook_url(){return`${this.config?.server}/api/v1/webhook/casso-sepay/callback?session_id=`+St()(this.config.payment_token_check||"")}},beforeMount(){this.getCameras(),this.getBanks(),this.getPrinters(),this.getLUTs(),this.callback_load_config_complete=this.genTestOrder},methods:{goBack(){this.$router.go(-1)},copyWebhookURL(){navigator.clipboard.writeText(this._get_webhook_url),this.$AF.$msgSuccess("Đã sao chép URL webhook")},addGroupPackage(){this.config.packages.push({id:"group_"+(new Date).getTime().toString(),name:"Nhóm gói",image:"",items:[]})},addPackage(e){this.config.packages[e].items.push({id:"package_"+(new Date).getTime().toString(),name:"Gói mới",price:1e5,count:0})},async initialDeletePackageGroup(e){this.config.packages.length<=1?this.$AF.$msgWarning("Phải có ít nhất 1 nhóm gói"):await this.$AF.$qConfirm("Bạn có chắc muốn xóa nhóm gói này không?")&&(this.config.packages.splice(e,1),this.$AF.$msgSuccess("Xóa nhóm gói thành công"))},async initialDeleteLUT(e){if(await this.$AF.$qConfirm(`Bạn có chắc muốn xóa bộ lọc "${e.name}" không?`)){this.lut.loading=!0;try{await this.$fetch.base.deleteLUT(e.file),this.$AF.$msgSuccess("Xóa bộ lọc thành công"),await this.getLUTs()}catch(t){this.$AF.$msgWarning("Xóa bộ lọc thất bại: "+t.message)}this.lut.loading=!1}},async getLUTs(){this.lut.loading=!0,this.lut.list=await this.$fetch.base.getLUTs()||[],this.lut.loading=!1},async onFinalAddLut(){if(this.lut.upload_file_name.trim().length<3)return this.$AF.$msgWarning("Vui lòng nhập tên gợi nhớ hợp lệ"),0;this.lut.loading=!0;try{await this.$fetch.base.uploadLUT({file:this.lut.upload_file,name:this.lut.upload_file_name.trim()});this.lut.upload_file_show=!1,this.getLUTs(),this.$AF.$msgSuccess("Thêm bộ lọc LUT thành công")}catch(e){console.log("e",e)}this.lut.loading=!1},handleLutFileChange(e){this.lut.upload_file=e.target.files[0]||null,this.lut.upload_file&&(this.lut.upload_file_name=this.lut.upload_file.name,this.lut.upload_file_show=!0)},async getPrinters(){this.printer.loading=!0,this.printer.list=await this.$fetch.base.getPrinters()||[],this.printer.loading=!1},async genTestOrder(){this.payment_order_id||(this.payment_order_id=this.genPaymentOrderId()),await this.$nextTick();let e=await this.genQrCode({data:W.generateQRData({accountName:this.config.payment_account_name||"Người dùng",accountNumber:this.config.payment_account_number,amount:this.input_amount,bankCode:this.config.payment_bank_id,transactionMessage:this.payment_order_id}),image:this.config.payment_qr_logo,color:this.config.payment_qr_color,background:this.config.payment_qr_background,shape:this.config.payment_qr_shape});this.preview_qr_url=e},copyDeviceId(){navigator.clipboard.writeText(this.device_id),this.$AF.$msgSuccess("Đã sao chép mã thiết bị")},async trySaveDeviceConfig(){if(await this.$AF.$qConfirm("Bạn có chắc muốn lưu cài đặt?")){try{this.saving=!0;let e=JSON.parse(JSON.stringify(this.config));delete e.license,await this.$fetch.base.updateConfig(e),this.$AF.$msgSuccess("Lưu cài đặt thành công")}catch(e){this.$AF.$msgWarning("Lưu cài đặt thất bại: "+e.message)}this.saving=!1}},async getCameras(){this.camera.loading=!0,this.camera.list=await this.$fetch.base.getCameras()||[],this.camera.loading=!1},async getBanks(){this.bank.loading=!0,this.bank.list=await this.$fetch.base.getBanks()||[],this.bank.loading=!1}}};const Xt=(0,b.A)(Dt,[["render",ut]]);var Wt=Xt;const jt={class:"page__setting-template-manager"},Rt={style:{width:"100%","text-align":"left"}},Pt={style:{padding:"0 12px"}},qt={style:{padding:"12px"}},Ot={style:{"font-size":"12px",color:"grey","margin-top":"4px"}},Nt=["src","onClick"],Qt={class:"header-button__container"},Bt={class:"guide-label guide-label-left"},Kt={class:"guide-label guide-label-top"},Gt={style:{position:"relative"}},Ht=["onMousedown","onDblclick","onContextmenu"],Jt=["onMousedown"],Yt=["onMousedown"],Zt=["onMousedown"],ea=["onMousedown"],ta=["onMousedown"],aa={class:"pos"},na={style:{height:"100vh",textAlign:"left",minWidth:"200px"}},ia={style:{padding:"0 12px"}},la={style:{padding:"0 12px"}},sa={style:{padding:"0 12px"}},oa={class:"field-label"};function ra(e,t,a,l,s,o){const r=(0,i.g2)("Icon"),c=(0,i.g2)("n-button"),d=(0,i.g2)("n-flex"),h=(0,i.g2)("n-input"),u=(0,i.g2)("n-empty"),p=(0,i.g2)("n-popover"),g=(0,i.g2)("n-scrollbar"),_=(0,i.g2)("n-select"),m=(0,i.g2)("n-switch"),f=(0,i.g2)("n-col"),b=(0,i.g2)("n-input-number"),k=(0,i.g2)("n-row"),v=(0,i.g2)("n-color-picker"),y=(0,i.g2)("component__printer-setting"),w=(0,i.g2)("n-tab-pane"),x=(0,i.g2)("component__drag-item"),F=(0,i.g2)("n-checkbox"),C=(0,i.g2)("n-slider"),L=(0,i.g2)("n-alert"),$=(0,i.g2)("n-space"),E=(0,i.g2)("n-radio"),S=(0,i.g2)("n-radio-group"),T=(0,i.g2)("n-tabs"),U=(0,i.g2)("n-split");return(0,i.uX)(),(0,i.CE)("div",jt,[(0,i.bF)(d,{align:"center",class:"header"},{default:(0,i.k6)(()=>[(0,i.bF)(c,{size:"tiny",onClick:t[0]||(t[0]=t=>e.$router.back()),tertiary:""},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:alt-arrow-left-broken"})]),default:(0,i.k6)(()=>[t[55]||(t[55]=(0,i.eW)(" Cài đặt ",-1))]),_:1}),t[56]||(t[56]=(0,i.Lk)("div",null," Quản lí khung ảnh ",-1))]),_:1}),(0,i.Lk)("div",null,[(0,i.bF)(U,{size:s.panel_size.main,"onUpdate:size":t[54]||(t[54]=e=>s.panel_size.main=e),direction:"horizontal",style:{height:"calc(100vh - 50px)"},max:.75,min:.15},{1:(0,i.k6)(()=>[(0,i.Lk)("div",Rt,[(0,i.Lk)("div",Pt,[(0,i.bF)(h,{value:e.frame.filter.keyword,"onUpdate:value":t[1]||(t[1]=t=>e.frame.filter.keyword=t),placeholder:"Tìm kiếm khung ảnh ..."},{prefix:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:magnifer-broken"})]),_:1},8,["value"])]),(0,i.bF)(g,{style:{"max-height":"calc(100vh - 90px)"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",qt,[0===e.filtered_frame_list?((0,i.uX)(),(0,i.Wv)(u,{key:0,style:{"margin-top":"60px"}},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:trash-bin-trash-broken",color:"gray"})]),default:(0,i.k6)(()=>[t[57]||(t[57]=(0,i.Lk)("div",{style:{"margin-top":"24px"}}," Chưa có khung ảnh nào. Hãy tạo mới! ",-1))]),_:1})):(0,i.Q3)("",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.filtered_frame_list,a=>((0,i.uX)(),(0,i.Wv)(p,{trigger:"hover",placement:"right-start"},{trigger:(0,i.k6)(()=>[(0,i.Lk)("div",{class:(0,R.C4)({"frame-item":!0,active:a.id===s.current_page.id}),style:{width:"100%"}},[(0,i.Lk)("div",null,[(0,i.Lk)("div",null,(0,R.v_)(a.name),1),(0,i.bF)(d,{justify:"space-between",align:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",Ot," Kích thước: "+(0,R.v_)(a.size)+" | DPI: "+(0,R.v_)(a.dpi),1),(0,i.bF)(c,{size:"small",tertiary:"",onMouseout:(0,n.D$)(()=>{},["prevent"]),onClick:()=>this.handleLoadFrame(a)},{default:(0,i.k6)(()=>[...t[58]||(t[58]=[(0,i.eW)("Tải ",-1)])]),_:1},8,["onClick"])]),_:2},1024)])],2)]),default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[(0,i.Lk)("img",{src:e.$fetch.base.getFrameImageUrl(a.id),style:{"border-radius":"6px",width:"100%","max-width":"250px","max-height":"calc(100vh - 200px)"},onClick:t=>e.$AF.$imageView(e.$fetch.base.getFrameImageUrl(a.id))},null,8,Nt)]),(0,i.bF)(d,{justify:"end",style:{"margin-top":"6px"}},{default:(0,i.k6)(()=>[(0,i.bF)(c,{size:"small",tertiary:"",onClick:()=>this.handleCopyFrame(a)},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:layers-broken"})]),default:(0,i.k6)(()=>[t[59]||(t[59]=(0,i.eW)(" Sao chép ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))])]),_:1})])]),2:(0,i.k6)(()=>[(0,i.bF)(U,{size:s.panel_size.secondary,"onUpdate:size":t[53]||(t[53]=e=>s.panel_size.secondary=e),min:.2,max:.75},{1:(0,i.k6)(()=>[(0,i.Lk)("div",{class:"view-container",onWheel:t[11]||(t[11]=(0,n.D$)((...e)=>o.handleWheel&&o.handleWheel(...e),["prevent"])),onMousedown:t[12]||(t[12]=(...e)=>o.handleMouseDown&&o.handleMouseDown(...e)),onMousemove:t[13]||(t[13]=(...e)=>o.handleMouseMove&&o.handleMouseMove(...e)),onMouseup:t[14]||(t[14]=(...e)=>o.handleMouseUp&&o.handleMouseUp(...e)),onMouseleave:t[15]||(t[15]=(...e)=>o.handleMouseUp&&o.handleMouseUp(...e)),style:(0,R.Tr)({cursor:s.dragging?"grabbing":"grab"})},[(0,i.Lk)("div",Qt,[(0,i.bF)(d,{justify:"space-between",align:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{align:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(c,{tertiary:"",type:"success",style:{"margin-left":"12px"},onClick:o.initialNewFrame},{default:(0,i.k6)(()=>[...t[60]||(t[60]=[(0,i.eW)(" Tạo mới ",-1)])]),_:1},8,["onClick"]),t[62]||(t[62]=(0,i.Lk)("div",{style:{height:"20px","border-right":"1px dashed rgb(90,90,90)"}},null,-1)),(0,i.bF)(c,{type:"primary",onClick:o.saveTemplate,loading:s.saving},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:diskette-broken"})]),default:(0,i.k6)(()=>[t[61]||(t[61]=(0,i.eW)(" Lưu khung ảnh ",-1))]),_:1},8,["onClick","loading"])]),_:1}),(0,i.bF)(c,{style:{"margin-right":"12px"},onClick:o.testRenderCanvas},{default:(0,i.k6)(()=>[...t[63]||(t[63]=[(0,i.eW)("Xem thử",-1)])]),_:1},8,["onClick"])]),_:1})]),(0,i.Lk)("div",{class:"virtual-rule-top",style:(0,R.Tr)({left:s.view.left+"px",top:s.view.top-30+"px",width:s.view.width*s.view.scale+"px"})},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Math.ceil(o.pixelToMM(s.view.width)/10),e=>((0,i.uX)(),(0,i.CE)("div",{key:"vt-"+e,class:"ruler-number",style:(0,R.Tr)({left:o.mmToPixel(10*e)*s.view.scale+"px"})},(0,R.v_)(10*e),5))),128))],4),(0,i.Lk)("div",{class:"virtual-rule-bottom",style:(0,R.Tr)({left:s.view.left+"px",top:s.view.top+s.view.height*s.view.scale+"px",width:s.view.width*s.view.scale+"px"})},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Math.ceil(o.pixelToMM(s.view.width)/10),e=>((0,i.uX)(),(0,i.CE)("div",{key:"vb-"+e,class:"ruler-number",style:(0,R.Tr)({left:o.mmToPixel(10*e)*s.view.scale+"px"})},(0,R.v_)(10*e),5))),128))],4),(0,i.Lk)("div",{class:"virtual-rule-left",style:(0,R.Tr)({left:s.view.left-30+"px",top:s.view.top+"px",height:s.view.height*s.view.scale+"px"})},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Math.ceil(o.pixelToMM(s.view.height)/10),e=>((0,i.uX)(),(0,i.CE)("div",{key:"vl-"+e,class:"ruler-number",style:(0,R.Tr)({top:o.mmToPixel(10*e)*s.view.scale+"px"})},(0,R.v_)(10*e),5))),128))],4),(0,i.Lk)("div",{class:"virtual-rule-right",style:(0,R.Tr)({left:s.view.left+s.view.width*s.view.scale+"px",top:s.view.top+"px",height:s.view.height*s.view.scale+"px"})},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Math.ceil(o.pixelToMM(s.view.height)/10),e=>((0,i.uX)(),(0,i.CE)("div",{key:"vr-"+e,class:"ruler-number",style:(0,R.Tr)({top:o.mmToPixel(10*e)*s.view.scale+"px"})},(0,R.v_)(10*e),5))),128))],4),s.selectedEl?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",{class:"alignment-guide-horizontal",style:(0,R.Tr)({left:s.view.left+"px",top:s.view.top+s.selectedEl.top*s.view.scale+"px",width:s.view.width*s.view.scale+"px"})},[(0,i.Lk)("span",Bt,(0,R.v_)(Math.round(s.selectedEl.top))+"px",1)],4),(0,i.Lk)("div",{class:"alignment-guide-vertical",style:(0,R.Tr)({left:s.view.left+s.selectedEl.left*s.view.scale+"px",top:s.view.top+"px",height:s.view.height*s.view.scale+"px"})},[(0,i.Lk)("span",Kt,(0,R.v_)(Math.round(s.selectedEl.left))+"px",1)],4)],64)):(0,i.Q3)("",!0),(0,i.Lk)("div",{class:(0,R.C4)(["page-view",{"dragging-over":s.isDraggingOver}]),style:(0,R.Tr)({width:s.view.width+"px",height:s.view.height+"px",left:s.view.left+"px",top:s.view.top+"px",backgroundColor:s.current_page.background_color,position:"absolute",transform:"scale("+s.view.scale+")",transformOrigin:"top left"}),onDragover:t[7]||(t[7]=(0,n.D$)((...e)=>o.handleDragOver&&o.handleDragOver(...e),["prevent"])),onDragleave:t[8]||(t[8]=(0,n.D$)((...e)=>o.handleDragLeave&&o.handleDragLeave(...e),["prevent"])),onDrop:t[9]||(t[9]=(0,n.D$)((...e)=>o.handleDrop&&o.handleDrop(...e),["prevent"])),onClick:t[10]||(t[10]=(...e)=>o.handlePageClick&&o.handlePageClick(...e))},[(0,i.Lk)("div",Gt,[s.showCenterGuideVertical?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"center-guide-vertical",style:(0,R.Tr)({left:s.view.width/2+"px",top:"0px",height:s.view.height+"px",position:"absolute",borderLeft:"3px dashed rgba(0,0,0,0.1)"})},null,4)):(0,i.Q3)("",!0),s.showCenterGuideHorizontal?((0,i.uX)(),(0,i.CE)("div",{key:1,class:"center-guide-horizontal",style:(0,R.Tr)({left:"0px",top:s.view.height/2+"px",width:s.view.width+"px",position:"absolute",borderBottom:"3px dashed rgba(0,0,0,0.1)"})},null,4)):(0,i.Q3)("",!0)]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.current_page.els,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:(0,R.C4)(["element-wrapper",{selected:s.selectedEl&&s.selectedEl.id===e.id}]),style:(0,R.Tr)({position:"absolute",left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px",transform:"rotate("+e.rotate_angle+"deg)",zIndex:e.z_index}),onMousedown:(0,n.D$)(t=>o.handleElementMouseDown(t,e),["stop"]),onDblclick:(0,n.D$)(t=>o.handleElementDblClick(t,e),["stop"]),onContextmenu:(0,n.D$)(t=>o.handleElementContextMenu(t,e),["stop","prevent"])},[(0,i.Lk)("div",{class:"element-content",style:(0,R.Tr)({width:"100%",height:"100%",border:e.border_width+"px solid "+e.border_color,borderTopLeftRadius:e.border_radius_top_left+"px",borderTopRightRadius:e.border_radius_top_right+"px",borderBottomLeftRadius:e.border_radius_bottom_left+"px",borderBottomRightRadius:e.border_radius_bottom_right+"px",opacity:e.opacity,backgroundImage:e.image_url?`url(${e.image_url})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",fontFamily:e.font_family,fontSize:e.font_size+"px",color:e.font_color,backgroundColor:e.background_color,fontWeight:e.font_bold?"bold":"normal",fontStyle:e.font_italic?"italic":"normal",textDecoration:e.font_underline?"underline":"none",textAlign:e.text_align})},[e.text_content?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"element-text",style:(0,R.Tr)({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",fontFamily:e.font_family,fontSize:e.font_size+"px",color:e.font_color,fontWeight:e.font_bold?"bold":"normal",fontStyle:e.font_italic?"italic":"normal",textDecoration:e.font_underline?"underline":"none",textAlign:e.text_align,width:"100%"})},(0,R.v_)(e.text_content),5)):(0,i.Q3)("",!0)],4),s.selectedEl&&s.selectedEl.id===e.id?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",{class:"z-index-badge",style:(0,R.Tr)({transform:"rotate("+-(e.rotate_angle||0)+"deg)"})}," Z: "+(0,R.v_)(e.z_index),5),(0,i.Lk)("div",{class:"selection-border",style:(0,R.Tr)({top:-(e.border_width||0)+"px",left:-(e.border_width||0)+"px",right:-(e.border_width||0)+"px",bottom:-(e.border_width||0)+"px"})},null,4),(0,i.Lk)("div",{class:"resize-handle resize-nw",onMousedown:(0,n.D$)(t=>o.handleResizeStart(t,e,"nw"),["stop"])},null,40,Jt),(0,i.Lk)("div",{class:"resize-handle resize-ne",onMousedown:(0,n.D$)(t=>o.handleResizeStart(t,e,"ne"),["stop"])},null,40,Yt),(0,i.Lk)("div",{class:"resize-handle resize-sw",onMousedown:(0,n.D$)(t=>o.handleResizeStart(t,e,"sw"),["stop"])},null,40,Zt),(0,i.Lk)("div",{class:"resize-handle resize-se",onMousedown:(0,n.D$)(t=>o.handleResizeStart(t,e,"se"),["stop"])},null,40,ea),(0,i.Lk)("div",{class:"rotate-handle",onMousedown:(0,n.D$)(t=>o.handleRotateStart(t,e),["stop"])},[(0,i.bF)(r,{icon:"mdi:rotate-right",style:{"font-size":"16px"}})],40,ta)],64)):(0,i.Q3)("",!0)],46,Ht))),128)),s.contextMenuVisible?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"element-context-menu",style:(0,R.Tr)({left:s.contextMenuX+"px",top:s.contextMenuY+"px"})},[(0,i.Lk)("div",{class:"context-item",onClick:t[2]||(t[2]=e=>o.changeZIndex(1))},"Lên"),(0,i.Lk)("div",{class:"context-item",onClick:t[3]||(t[3]=e=>o.changeZIndex(-1))},"Xuống"),(0,i.Lk)("div",{class:"context-item",onClick:t[4]||(t[4]=(...e)=>o.bringToFront&&o.bringToFront(...e))},"Lên trên cùng"),(0,i.Lk)("div",{class:"context-item",onClick:t[5]||(t[5]=(...e)=>o.sendToBack&&o.sendToBack(...e))},"Xuống cuối cùng"),(0,i.Lk)("div",{class:"context-item danger",onClick:t[6]||(t[6]=(...e)=>o.deleteElementFromContextMenu&&o.deleteElementFromContextMenu(...e))},"Xoá")],4)):(0,i.Q3)("",!0)],38),(0,i.Lk)("div",aa,"Z: "+(0,R.v_)(s.view.scale.toFixed(5))+", W:H "+(0,R.v_)(s.view.width)+"x"+(0,R.v_)(s.view.height)+"px | "+(0,R.v_)(o.pixelToMM(s.view.width))+"x"+(0,R.v_)(o.pixelToMM(s.view.height))+"mm ",1)],36)]),2:(0,i.k6)(()=>[(0,i.Lk)("div",na,[(0,i.bF)(T,{type:"card",value:s.main_tab,"onUpdate:value":t[52]||(t[52]=e=>s.main_tab=e)},{default:(0,i.k6)(()=>[(0,i.bF)(w,{tab:"Khung",name:"1"},{default:(0,i.k6)(()=>[(0,i.bF)(g,{style:{"max-height":"calc(100vh - 100px)"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",ia,[t[85]||(t[85]=(0,i.Lk)("p",{class:"field-label"},"Tên khung",-1)),(0,i.bF)(h,{value:s.current_page.name,"onUpdate:value":t[16]||(t[16]=e=>s.current_page.name=e),ref:"input_frame_name",placeholder:"Nhập tên khung ảnh..."},null,8,["value"]),t[86]||(t[86]=(0,i.Lk)("p",{class:"field-label"},"Khổ giấy",-1)),(0,i.bF)(_,{value:s.current_page.size,"onUpdate:value":t[17]||(t[17]=e=>s.current_page.size=e),options:s.page_size.map(e=>({label:e[0],value:e[1]}))},null,8,["value","options"]),t[87]||(t[87]=(0,i.Lk)("p",{class:"field-label"},"DPI",-1)),(0,i.bF)(_,{value:s.current_page.dpi,"onUpdate:value":t[18]||(t[18]=e=>s.current_page.dpi=e),options:s.dpi_options.map(e=>({label:e.toString(),value:e}))},null,8,["value","options"]),t[88]||(t[88]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:12},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[66]||(t[66]=(0,i.Lk)("p",{class:"field-label"},"Snap to Grid",-1)),(0,i.bF)(m,{value:s.snapToGrid,"onUpdate:value":t[19]||(t[19]=e=>s.snapToGrid=e)},{checked:(0,i.k6)(()=>[...t[64]||(t[64]=[(0,i.eW)("Bật",-1)])]),unchecked:(0,i.k6)(()=>[...t[65]||(t[65]=[(0,i.eW)("Tắt",-1)])]),_:1},8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[68]||(t[68]=(0,i.Lk)("p",{class:"field-label"},"Kích thước Grid (px)",-1)),(0,i.bF)(b,{value:s.snapSize,"onUpdate:value":t[20]||(t[20]=e=>s.snapSize=e),step:1,min:1,max:50,disabled:!s.snapToGrid,style:{width:"100%"}},{suffix:(0,i.k6)(()=>[...t[67]||(t[67]=[(0,i.eW)("px",-1)])]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t[89]||(t[89]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:12},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[71]||(t[71]=(0,i.Lk)("p",{class:"field-label"},"Thanh chia giữa dọc",-1)),(0,i.bF)(m,{value:s.showCenterGuideVertical,"onUpdate:value":t[21]||(t[21]=e=>s.showCenterGuideVertical=e),size:"small"},{checked:(0,i.k6)(()=>[...t[69]||(t[69]=[(0,i.eW)("Hiện",-1)])]),unchecked:(0,i.k6)(()=>[...t[70]||(t[70]=[(0,i.eW)("Ẩn",-1)])]),_:1},8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[74]||(t[74]=(0,i.Lk)("p",{class:"field-label"},"Thanh chia giữa ngang",-1)),(0,i.bF)(m,{value:s.showCenterGuideHorizontal,"onUpdate:value":t[22]||(t[22]=e=>s.showCenterGuideHorizontal=e),size:"small"},{checked:(0,i.k6)(()=>[...t[72]||(t[72]=[(0,i.eW)("Hiện",-1)])]),unchecked:(0,i.k6)(()=>[...t[73]||(t[73]=[(0,i.eW)("Ẩn",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t[90]||(t[90]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:12},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[77]||(t[77]=(0,i.Lk)("p",{class:"field-label"},"Ghép 2 ảnh",-1)),(0,i.bF)(m,{value:s.current_page.merge,"onUpdate:value":t[23]||(t[23]=e=>s.current_page.merge=e)},{checked:(0,i.k6)(()=>[...t[75]||(t[75]=[(0,i.eW)("Có",-1)])]),unchecked:(0,i.k6)(()=>[...t[76]||(t[76]=[(0,i.eW)("Không",-1)])]),_:1},8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[80]||(t[80]=(0,i.Lk)("p",{class:"field-label"},"Xoay ảnh trước khi in",-1)),(0,i.bF)(m,{value:s.current_page.rotate_before_print,"onUpdate:value":t[24]||(t[24]=e=>s.current_page.rotate_before_print=e)},{checked:(0,i.k6)(()=>[...t[78]||(t[78]=[(0,i.eW)("Có",-1)])]),unchecked:(0,i.k6)(()=>[...t[79]||(t[79]=[(0,i.eW)("Không",-1)])]),_:1},8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[81]||(t[81]=(0,i.Lk)("p",{class:"field-label"},"Màu nền",-1)),(0,i.bF)(v,{value:s.current_page.background_color,"onUpdate:value":t[25]||(t[25]=e=>s.current_page.background_color=e),style:{width:"100px"},modes:["hex"],"show-alpha":""},null,8,["value"])]),_:1})]),_:1}),t[91]||(t[91]=(0,i.Lk)("p",{class:"field-label"},"Máy in",-1)),(0,i.bF)(_,{value:s.current_page.printer_id,"onUpdate:value":t[26]||(t[26]=e=>s.current_page.printer_id=e),filterable:"",options:[{label:"Mặc định",value:""},...s.printer.list.map(e=>({label:e.name,value:e.id}))]},null,8,["value","options"]),s.current_page.printer_id?((0,i.uX)(),(0,i.Wv)(y,{key:0,printer_id:s.current_page.printer_id,current_setting:s.current_page.printer_setting,"onUpdate:current_setting":t[27]||(t[27]=e=>s.current_page.printer_setting=e),is_all:!1,allow_keys:["PageSize","Cutter","Finish","Resolution"]},null,8,["printer_id","current_setting"])):(0,i.Q3)("",!0),(0,i.bF)(d,{style:{"margin-top":"16px"},justify:"end"},{default:(0,i.k6)(()=>[(0,i.bF)(c,{onClick:o.testFramePrinter,size:"small"},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:printer-2-broken"})]),default:(0,i.k6)(()=>[t[82]||(t[82]=(0,i.eW)(" In thử khung ảnh ",-1))]),_:1},8,["onClick"])]),_:1}),t[92]||(t[92]=(0,i.Lk)("p",{class:"field-label"},"Xuất hiện trong gói",-1)),(0,i.bF)(_,{value:s.current_page.group_package_ids,"onUpdate:value":t[28]||(t[28]=e=>s.current_page.group_package_ids=e),filterable:"",multiple:"",options:[...(e.config?.packages||[]).map(e=>({label:e.title,value:e.id}))]},null,8,["value","options"]),s.current_page.id?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[t[84]||(t[84]=(0,i.Lk)("hr",null,null,-1)),(0,i.Lk)("div",null,[(0,i.bF)(c,{type:"error",style:{width:"100%"},onClick:o.tryDeleteCurrentFrame},{default:(0,i.k6)(()=>[...t[83]||(t[83]=[(0,i.eW)(" Xoá khung ảnh ",-1)])]),_:1},8,["onClick"])])],64)):(0,i.Q3)("",!0),t[93]||(t[93]=(0,i.Lk)("div",{style:{height:"20px"}},null,-1))])]),_:1})]),_:1}),(0,i.bF)(w,{tab:"Chủ thể",name:"2"},{default:(0,i.k6)(()=>[(0,i.bF)(g,{style:{"max-height":"calc(100vh - 100px)"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",la,[t[94]||(t[94]=(0,i.Lk)("p",{class:"field-label"},"Ảnh chụp",-1)),(0,i.bF)(k,{gutter:12},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.object.main,e=>((0,i.uX)(),(0,i.Wv)(x,{title:e.title,description:"Ảnh chụp từ máy ảnh",data:e},null,8,["title","data"]))),256))]),_:1}),t[95]||(t[95]=(0,i.Lk)("hr",null,null,-1)),t[96]||(t[96]=(0,i.Lk)("p",{class:"field-label"},"QR code & Văn bản",-1)),(0,i.bF)(k,{gutter:12},{default:(0,i.k6)(()=>[(0,i.bF)(x,{title:"QR tải ảnh",description:"QR tải ảnh",data:{main_object_class:"qrcode",id:"qrcode:lib"}}),(0,i.bF)(x,{title:"Văn bản",description:"Chữ tùy chỉnh",data:{main_object_class:"text",id:"text:custom"}})]),_:1}),t[97]||(t[97]=(0,i.Lk)("hr",null,null,-1)),t[98]||(t[98]=(0,i.Lk)("p",{class:"field-label"},"Khác",-1)),(0,i.bF)(k,{gutter:12},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.object.custom,e=>((0,i.uX)(),(0,i.Wv)(x,{data:e,aspect_ratio:1,image:e.image_url},null,8,["data","image"]))),256))]),_:1}),t[99]||(t[99]=(0,i.Lk)("div",{style:{height:"50px"}},null,-1))])]),_:1})]),_:1}),(0,i.bF)(w,{tab:"Thuộc tính",name:"3"},{default:(0,i.k6)(()=>[(0,i.bF)(g,{style:{"max-height":"calc(100vh - 100px)"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",sa,[s.selectedEl?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("p",oa,"ID: "+(0,R.v_)(s.selectedEl.id),1),t[126]||(t[126]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:8},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[100]||(t[100]=(0,i.Lk)("p",{class:"field-label"},"X (px)",-1)),(0,i.bF)(b,{value:s.selectedEl.left,"onUpdate:value":t[29]||(t[29]=e=>s.selectedEl.left=e),step:1,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[101]||(t[101]=(0,i.Lk)("p",{class:"field-label"},"Y (px)",-1)),(0,i.bF)(b,{value:s.selectedEl.top,"onUpdate:value":t[30]||(t[30]=e=>s.selectedEl.top=e),step:1,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),(0,i.bF)(k,{gutter:8},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[102]||(t[102]=(0,i.Lk)("p",{class:"field-label"},"Rộng (px)",-1)),(0,i.bF)(b,{value:s.selectedEl.width,"onUpdate:value":[t[31]||(t[31]=e=>s.selectedEl.width=e),o.handleWidthChange],step:1,min:10,size:"small",style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[103]||(t[103]=(0,i.Lk)("p",{class:"field-label"},"Cao (px)",-1)),(0,i.bF)(b,{value:s.selectedEl.height,"onUpdate:value":[t[32]||(t[32]=e=>s.selectedEl.height=e),o.handleHeightChange],step:1,min:10,size:"small",style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:1})]),_:1}),"image"===s.selectedEl.main_object_class?((0,i.uX)(),(0,i.Wv)(F,{key:0,checked:s.selectedEl.lock_aspect_ratio,"onUpdate:checked":t[33]||(t[33]=e=>s.selectedEl.lock_aspect_ratio=e),size:"small",style:{"margin-top":"4px"}},{default:(0,i.k6)(()=>[...t[104]||(t[104]=[(0,i.eW)(" Khóa tỉ lệ 3:4 ",-1)])]),_:1},8,["checked"])):(0,i.Q3)("",!0),t[127]||(t[127]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:8},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[105]||(t[105]=(0,i.Lk)("p",{class:"field-label"},"Góc xoay (°)",-1)),(0,i.bF)(b,{value:s.selectedEl.rotate_angle,"onUpdate:value":t[34]||(t[34]=e=>s.selectedEl.rotate_angle=e),step:1,min:-360,max:360,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[106]||(t[106]=(0,i.Lk)("p",{class:"field-label"},"Z-Index",-1)),(0,i.bF)(b,{value:s.selectedEl.z_index,"onUpdate:value":t[35]||(t[35]=e=>s.selectedEl.z_index=e),step:1,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t[128]||(t[128]=(0,i.Lk)("p",{class:"field-label"},"Độ mờ",-1)),(0,i.bF)(C,{value:s.selectedEl.opacity,"onUpdate:value":t[36]||(t[36]=e=>s.selectedEl.opacity=e),step:.01,min:0,max:1},null,8,["value"]),t[129]||(t[129]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:8},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[107]||(t[107]=(0,i.Lk)("p",{class:"field-label"},"Bo góc ↖",-1)),(0,i.bF)(b,{value:s.selectedEl.border_radius_top_left,"onUpdate:value":t[37]||(t[37]=e=>s.selectedEl.border_radius_top_left=e),step:1,min:0,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[108]||(t[108]=(0,i.Lk)("p",{class:"field-label"},"Bo góc ↗",-1)),(0,i.bF)(b,{value:s.selectedEl.border_radius_top_right,"onUpdate:value":t[38]||(t[38]=e=>s.selectedEl.border_radius_top_right=e),step:1,min:0,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[109]||(t[109]=(0,i.Lk)("p",{class:"field-label"},"Bo góc ↙",-1)),(0,i.bF)(b,{value:s.selectedEl.border_radius_bottom_left,"onUpdate:value":t[39]||(t[39]=e=>s.selectedEl.border_radius_bottom_left=e),step:1,min:0,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[110]||(t[110]=(0,i.Lk)("p",{class:"field-label"},"Bo góc ↘",-1)),(0,i.bF)(b,{value:s.selectedEl.border_radius_bottom_right,"onUpdate:value":t[40]||(t[40]=e=>s.selectedEl.border_radius_bottom_right=e),step:1,min:0,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t[130]||(t[130]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(k,{gutter:8},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[111]||(t[111]=(0,i.Lk)("p",{class:"field-label"},"Viền (px)",-1)),(0,i.bF)(b,{value:s.selectedEl.border_width,"onUpdate:value":t[41]||(t[41]=e=>s.selectedEl.border_width=e),step:1,min:0,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[112]||(t[112]=(0,i.Lk)("p",{class:"field-label"},"Màu viền",-1)),(0,i.bF)(v,{value:s.selectedEl.border_color,"onUpdate:value":t[42]||(t[42]=e=>s.selectedEl.border_color=e),size:"small",style:{width:"100%"},modes:["hex"],"show-alpha":""},null,8,["value"])]),_:1})]),_:1}),"text"===s.selectedEl.main_object_class?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[t[119]||(t[119]=(0,i.Lk)("hr",null,null,-1)),t[120]||(t[120]=(0,i.Lk)("p",{class:"field-label"},"Nội dung văn bản",-1)),(0,i.bF)(h,{ref:"textContentInput",value:s.selectedEl.text_content,"onUpdate:value":t[43]||(t[43]=e=>s.selectedEl.text_content=e),type:"textarea",placeholder:"Nhập nội dung...",rows:2,size:"small"},null,8,["value"]),(0,i.bF)(L,{type:"info",style:{"margin-top":"12px"}},{default:(0,i.k6)(()=>[...t[113]||(t[113]=[(0,i.eW)(" Có thể sử dụng các biến thay thế sau: ",-1),(0,i.Lk)("br",null,null,-1),(0,i.eW)(" [DATE] hoặc [NGAY]: chèn ngày hiện tại ",-1),(0,i.Lk)("br",null,null,-1),(0,i.eW)(" [TIME] hoặc [THOI_GIAN]: chèn giờ hiện tại ",-1)])]),_:1}),t[121]||(t[121]=(0,i.Lk)("p",{class:"field-label"},"Font chữ",-1)),(0,i.bF)(_,{filterable:"",value:s.selectedEl.font_family,"onUpdate:value":t[44]||(t[44]=e=>s.selectedEl.font_family=e),options:s.fontFamilyOptions,size:"small",style:{width:"100%"}},null,8,["value","options"]),(0,i.bF)(k,{gutter:8},{default:(0,i.k6)(()=>[(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[114]||(t[114]=(0,i.Lk)("p",{class:"field-label"},"Cỡ chữ (px)",-1)),(0,i.bF)(b,{value:s.selectedEl.font_size,"onUpdate:value":t[45]||(t[45]=e=>s.selectedEl.font_size=e),step:1,min:8,max:200,size:"small",style:{width:"100%"}},null,8,["value"])]),_:1}),(0,i.bF)(f,{span:12},{default:(0,i.k6)(()=>[t[115]||(t[115]=(0,i.Lk)("p",{class:"field-label"},"Màu chữ",-1)),(0,i.bF)(v,{value:s.selectedEl.font_color,"onUpdate:value":t[46]||(t[46]=e=>s.selectedEl.font_color=e),size:"small",style:{width:"100%"},modes:["hex"],"show-alpha":""},null,8,["value"])]),_:1})]),_:1}),t[122]||(t[122]=(0,i.Lk)("p",{class:"field-label"},"Màu nền",-1)),(0,i.bF)(v,{value:s.selectedEl.background_color,"onUpdate:value":t[47]||(t[47]=e=>s.selectedEl.background_color=e),size:"small",style:{width:"100%"},modes:["hex"],"show-alpha":""},null,8,["value"]),t[123]||(t[123]=(0,i.Lk)("p",{class:"field-label"},"Kiểu chữ",-1)),(0,i.bF)($,{size:"small"},{default:(0,i.k6)(()=>[(0,i.bF)(c,{size:"small",type:s.selectedEl.font_bold?"primary":"default",onClick:t[48]||(t[48]=e=>s.selectedEl.font_bold=!s.selectedEl.font_bold)},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"mdi:format-bold"})]),_:1},8,["type"]),(0,i.bF)(c,{size:"small",type:s.selectedEl.font_italic?"primary":"default",onClick:t[49]||(t[49]=e=>s.selectedEl.font_italic=!s.selectedEl.font_italic)},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"mdi:format-italic"})]),_:1},8,["type"]),(0,i.bF)(c,{size:"small",type:s.selectedEl.font_underline?"primary":"default",onClick:t[50]||(t[50]=e=>s.selectedEl.font_underline=!s.selectedEl.font_underline)},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"mdi:format-underline"})]),_:1},8,["type"])]),_:1}),t[124]||(t[124]=(0,i.Lk)("p",{class:"field-label"},"Căn chữ",-1)),(0,i.bF)(S,{value:s.selectedEl.text_align,"onUpdate:value":t[51]||(t[51]=e=>s.selectedEl.text_align=e),name:"text-align",size:"small"},{default:(0,i.k6)(()=>[(0,i.bF)($,{size:"small"},{default:(0,i.k6)(()=>[(0,i.bF)(E,{value:"left"},{default:(0,i.k6)(()=>[...t[116]||(t[116]=[(0,i.eW)("Trái",-1)])]),_:1}),(0,i.bF)(E,{value:"center"},{default:(0,i.k6)(()=>[...t[117]||(t[117]=[(0,i.eW)("Giữa",-1)])]),_:1}),(0,i.bF)(E,{value:"right"},{default:(0,i.k6)(()=>[...t[118]||(t[118]=[(0,i.eW)("Phải",-1)])]),_:1})]),_:1})]),_:1},8,["value"])],64)):(0,i.Q3)("",!0),t[131]||(t[131]=(0,i.Lk)("hr",null,null,-1)),(0,i.bF)(c,{type:"error",block:"",size:"small",onClick:o.deleteSelectedElement},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:trash-bin-trash-bold"})]),default:(0,i.k6)(()=>[t[125]||(t[125]=(0,i.eW)(" Xóa ",-1))]),_:1},8,["onClick"]),t[132]||(t[132]=(0,i.Lk)("div",{style:{height:"20px"}},null,-1))],64)):((0,i.uX)(),(0,i.Wv)(u,{key:1,description:"Chưa chọn chủ thể nào",style:{"margin-top":"50px"}},{icon:(0,i.k6)(()=>[(0,i.bF)(r,{icon:"solar:box-minimalistic-broken",style:{"font-size":"48px"}})]),_:1}))])]),_:1})]),_:1})]),_:1},8,["value"])])]),_:1},8,["size"])]),_:1},8,["size"])])])}a(8237);function ca(e,t,a,n,l,s){const o=(0,i.g2)("n-tooltip"),r=(0,i.g2)("Icon"),c=(0,i.g2)("n-icon"),d=(0,i.g2)("n-flex"),h=(0,i.g2)("n-col");return(0,i.uX)(),(0,i.Wv)(h,{span:12},{default:(0,i.k6)(()=>[(0,i.bF)(d,{class:"drag-item",draggable:"true",onDragstart:s.handleDragStart,onDragend:s.handleDragEnd,align:"center",justify:"center",style:(0,R.Tr)({aspectRatio:a.aspect_ratio})},{default:(0,i.k6)(()=>[a.title.length?((0,i.uX)(),(0,i.Wv)(o,{key:0,placement:"top"},{trigger:(0,i.k6)(()=>[(0,i.eW)((0,R.v_)(a.title),1)]),default:(0,i.k6)(()=>[(0,i.eW)(" "+(0,R.v_)(a.description),1)]),_:1})):(0,i.Q3)("",!0),a.icon?((0,i.uX)(),(0,i.Wv)(c,{key:1,size:32},{default:(0,i.k6)(()=>[(0,i.bF)(r,{icon:a.icon},null,8,["icon"])]),_:1})):(0,i.Q3)("",!0),a.image?((0,i.uX)(),(0,i.CE)("div",{key:2,style:(0,R.Tr)({width:"64px",height:"64px",backgroundImage:`url(${a.image})`,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"})},null,4)):(0,i.Q3)("",!0)]),_:1},8,["onDragstart","onDragend","style"])]),_:1})}var da={name:"component__drag-item",props:{title:{type:String,default:""},icon:{type:String,default:""},image:{type:String,default:""},description:{type:String,default:""},aspect_ratio:{type:Number,default:3},data:{type:Object,default:()=>({})}},data(){return{}},methods:{handleDragStart(e){e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("application/json",JSON.stringify(this.data)),e.target.classList.add("dragging")},handleDragEnd(e){e.target.classList.remove("dragging")}}};const ha=(0,b.A)(da,[["render",ca]]);var ua=ha,pa={name:"page__setting-template-manager",components:{Component__printerSetting:Vt,Component__modalContent:$t,Component__dragItem:ua},mixins:[j],data(){return{contextMenuVisible:!1,contextMenuX:0,contextMenuY:0,contextMenuTargetId:null,main_tab:"1",page_size:[["2x6 inch","2x6"],["4x6 inch","4x6"],["6x6 inch","6x6"],["8x6 inch","8x6"]],dpi_options:[300,600],panel_size:{main:.2,secondary:.75},object:{main:[],custom:[]},current_page:{dpi:300,size:"4x6",name:"",printer_id:"",merge:!1,rotate_before_print:!1,middle_cut:!1,template_id:null,els:[],background_color:"#ffffff",group_package_ids:[],printer_setting:{}},base_template:{},base_el:{id:"",name:"",image_url:"",left:0,top:0,width:80,height:80,opacity:1,border_width:0,border_color:"#ffffff",border_radius_top_left:0,border_radius_top_right:0,border_radius_bottom_left:0,border_radius_bottom_right:0,rotate_angle:0,z_index:0,main_object_class:"",main_object_id:"",font_family:"Arial",font_size:12,font_color:"#000000",background_color:"#ffffff",font_bold:!1,font_italic:!1,font_underline:!1,text_align:"center",text_content:""},view:{scale:1,left:0,top:0,width:0,height:0},dragging:!1,dragStart:{x:0,y:0,viewLeft:0,viewTop:0},baseScale:1,isDraggingOver:!1,focused_el:null,selectedEl:null,elementDragging:!1,elementDragStart:{x:0,y:0,left:0,top:0},resizing:!1,resizeStart:{x:0,y:0,width:0,height:0,left:0,top:0},resizeDirection:"",rotating:!1,rotateStart:{x:0,y:0,angle:0,centerX:0,centerY:0},snapToGrid:!0,snapSize:5,updatingDimensions:!1,showCenterGuideVertical:!0,showCenterGuideHorizontal:!0,fontFamilyOptions:[{label:"Arial",value:"Arial, sans-serif"},{label:"Times New Roman",value:"Times New Roman, serif"},{label:"Courier New",value:"Courier New, monospace"},{label:"Georgia",value:"Georgia, serif"},{label:"Verdana",value:"Verdana, sans-serif"},{label:"Trebuchet MS",value:"Trebuchet MS, sans-serif"},{label:"Comic Sans MS",value:"Comic Sans MS, cursive"},{label:"Impact",value:"Impact, fantasy"},{label:"Tahoma",value:"Tahoma, sans-serif"},{label:"Helvetica",value:"Helvetica, sans-serif"},{label:"Dancing Script",value:"Dancing Script, monospace"}],printer:{loading:!1,list:[]},saving:!1,preview:{show:!1,url:""}}},watch:{view:{deep:!0,handle:function(e){}},"current_page.size"(e){this.genPageView()},"current_page.dpi"(e){this.genPageView()},snapToGrid(e){e&&this.current_page.els.forEach(e=>{e.left=this.snapValue(e.left),e.top=this.snapValue(e.top),e.width=this.snapValue(e.width),e.height=this.snapValue(e.height)})},selectedEl:function(e,t){this.main_tab=e?"3":"2"}},beforeMount(){this.base_template=this.unbindObj(this.current_page),this.callback_load_config_complete=()=>{Array.from({length:this.config.image_max}).forEach(e=>{this.addMainObject("image")})},this.genPageView(),this.getCustomObject(),this.getPrinters(),this.getAllFrames(),window.addEventListener("resize",this.genPageView),window.addEventListener("click",this.hideContextMenu),window.testRenderCanvas=this.testRenderCanvas},beforeDestroy(){window.removeEventListener("resize",this.genPageView),window.removeEventListener("click",this.hideContextMenu)},methods:{async testFramePrinter(){let e=this.current_page.printer_id||this.config.printer_id;if(e){if(await this.$AF.$qConfirm("Bạn có chắc muốn gửi lệnh in thử không")){let e=await V({pageConfig:this.current_page,imageUrls:[],qrCodeUrl:await this.genQrCode({data:"Printer Test"})});e.blob?await this.$fetch.base.printImage({printer_id:this.current_page.printer_id||this.config.printer_id,imageFile:e.blob,copies:1,printer_setting:{...this.config.printer_setting||{},...this.current_page.printer_setting||{}}}):this.$AF.$msgWarning("Lỗi khi tạo ảnh mẫu để in thử")}}else this.$AF.$msgWarning("Vui lòng chọn máy in để in thử khung ảnh")},async tryDeleteCurrentFrame(){if(await this.$AF.$qConfirm("Bạn có chắc muốn xoá khung ảnh này không? Mọi thay đổi sẽ không thể khôi phục."))try{await this.$fetch.base.deleteFrame(this.current_page.id),this.$AF.$msgSuccess("Đã xoá khung ảnh"),this.current_page.els=[],this.initialNewFrame(),this.getAllFrames()}catch(e){console.log("e",e),this.$AF.$msgWarning("Lỗi khi xoá khung ảnh")}},async handleCopyFrame(e){if(await this.$AF.$qConfirm("Bạn có chắc muốn sao chép khung ảnh này không?")){let t=this.unbindObj(e);t.name=t.name+" (Sao chép)",delete t.id,this.current_page=t,this.$AF.$msgSuccess("Đã sao chép khung ảnh")}},async handleLoadFrame(e){let t=async e=>{this.current_page=this.unbindObj(e)};(0===this.current_page.els.length||await this.$AF.$qConfirm(`Bạn có chắc muốn tải khung ảnh "${e.name}" không? Mọi thay đổi chưa lưu sẽ bị mất.`))&&await t(e)},async initialNewFrame(){let e=()=>{this.current_page=this.unbindObj(this.base_template)};(0===this.current_page.els.length||await this.$AF.$qConfirm("Bạn có chắc muốn tạo khung ảnh mới không?"))&&e()},async testRenderCanvas(){let e=await V({pageConfig:this.current_page,imageUrls:[],qrCodeUrl:await this.genQrCode({data:"Xin chao"}),options:{}});console.log("c",e),e.url?this.$AF.$imageView(e.url):this.$AF.$msgWarning("Lỗi khi tạo ảnh xem trước")},async getCustomObject(){let e=await this.$fetch.base.listUploadedImages();this.object.custom=(e||[]).map(e=>({main_object_class:"custom_image",id:`custom_image:${e.filename}`,title:e.filename,image_url:this.$fetch.base.getUploadedImage(e.filename),background_color:"#ffffff00"}))},async getPrinters(){this.printer.loading=!0;try{this.printer.list=await this.$fetch.base.getPrinters()}catch(e){}this.printer.loading=!1},handleWidthChange(e){this.updatingDimensions||this.selectedEl&&"image"===this.selectedEl.main_object_class&&!1!==this.selectedEl.lock_aspect_ratio&&(this.updatingDimensions=!0,this.selectedEl.height=this.snapValue(Math.round(e/3*4)),this.$nextTick(()=>{this.updatingDimensions=!1}))},handleHeightChange(e){this.updatingDimensions||this.selectedEl&&"image"===this.selectedEl.main_object_class&&!1!==this.selectedEl.lock_aspect_ratio&&(this.updatingDimensions=!0,this.selectedEl.width=this.snapValue(Math.round(e/4*3)),this.$nextTick(()=>{this.updatingDimensions=!1}))},snapValue(e){return this.snapToGrid?Math.round(e/this.snapSize)*this.snapSize:e},mmToPixel(e){return e/25.4*this.current_page.dpi},pixelToMM(e){return 25.4*e/this.current_page.dpi},addMainObject(e){let t=this.object.main.filter(t=>t.main_object_class===e).length;this.object.main.push({main_object_class:e,id:`${e}:${t+1}`,title:"Ảnh chụp "+(t+1),text_content:"Ảnh chụp "+(t+1)})},handleWheel(e){const t=e.deltaY,a=.001,n=this.view.scale*(1-t*a);this.view.scale=Math.max(.1,Math.min(5,n))},handleMouseDown(e){this.dragging=!0,this.dragStart.x=e.clientX,this.dragStart.y=e.clientY,this.dragStart.viewLeft=this.view.left,this.dragStart.viewTop=this.view.top},handleMouseMove(e){if(this.dragging){const t=e.clientX-this.dragStart.x,a=e.clientY-this.dragStart.y;this.view.left=this.dragStart.viewLeft+t,this.view.top=this.dragStart.viewTop+a}else if(this.elementDragging&&this.selectedEl){const t=(e.clientX-this.elementDragStart.x)/this.view.scale,a=(e.clientY-this.elementDragStart.y)/this.view.scale;this.selectedEl.left=this.snapValue(this.elementDragStart.left+t),this.selectedEl.top=this.snapValue(this.elementDragStart.top+a)}else this.resizing&&this.selectedEl?this.handleResize(e):this.rotating&&this.selectedEl&&this.handleRotate(e)},handleMouseUp(){this.dragging=!1,this.elementDragging=!1,this.resizing=!1,this.rotating=!1},handlePageClick(e){e.target.classList.contains("page-view")&&(this.selectedEl=null)},handleElementContextMenu(e,t){this.selectedEl=t,this.contextMenuTargetId=t.id;const a=document.querySelector(".page-view");if(a){a.getBoundingClientRect();const t=a.parentElement;t.getBoundingClientRect();let n=e.clientX,i=e.clientY;this.contextMenuX=n,this.contextMenuY=i}this.contextMenuX=this.selectedEl.left+this.selectedEl.width,this.contextMenuY=this.selectedEl.top,this.contextMenuVisible=!0},hideContextMenu(){this.contextMenuVisible=!1,this.contextMenuTargetId=null},getContextTarget(){return this.contextMenuTargetId&&this.current_page.els.find(e=>e.id===this.contextMenuTargetId)||null},changeZIndex(e){const t=this.getContextTarget();t&&(t.z_index=(parseInt(t.z_index,10)||0)+e,this.hideContextMenu())},bringToFront(){const e=this.getContextTarget();if(!e)return;const t=this.current_page.els.reduce((e,t)=>Math.max(e,parseInt(t.z_index||0,10)),-1/0);e.z_index=(isFinite(t)?t:0)+1,this.hideContextMenu()},sendToBack(){const e=this.getContextTarget();if(!e)return;const t=this.current_page.els.reduce((e,t)=>Math.min(e,parseInt(t.z_index||0,10)),1/0);isFinite(t)?e.z_index=t-1:e.z_index=0,this.hideContextMenu()},deleteElementFromContextMenu(){const e=this.getContextTarget();if(!e)return;const t=this.current_page.els.findIndex(t=>t.id===e.id);-1!==t&&(this.current_page.els.splice(t,1),this.selectedEl&&this.selectedEl.id===e.id&&(this.selectedEl=null)),this.hideContextMenu()},handleElementMouseDown(e,t){this.selectedEl=t,this.elementDragging=!0,this.elementDragStart.x=e.clientX,this.elementDragStart.y=e.clientY,this.elementDragStart.left=t.left,this.elementDragStart.top=t.top},handleElementDblClick(e,t){void 0!==t.text_content&&(this.selectedEl=t,this.main_tab="3",this.$nextTick(()=>{this.$refs.textContentInput&&this.$refs.textContentInput.focus()}))},handleResizeStart(e,t,a){this.resizing=!0,this.resizeDirection=a,this.resizeStart.x=e.clientX,this.resizeStart.y=e.clientY,this.resizeStart.width=t.width,this.resizeStart.height=t.height,this.resizeStart.left=t.left,this.resizeStart.top=t.top},handleResize(e){const t=(e.clientX-this.resizeStart.x)/this.view.scale,a=(e.clientY-this.resizeStart.y)/this.view.scale,n="image"===this.selectedEl.main_object_class&&!1!==this.selectedEl.lock_aspect_ratio;switch(this.resizeDirection){case"se":if(n){const e=this.snapValue(Math.max(20,this.resizeStart.width+t));this.selectedEl.width=e,this.selectedEl.height=this.snapValue(Math.round(e/3*4))}else this.selectedEl.width=this.snapValue(Math.max(20,this.resizeStart.width+t)),this.selectedEl.height=this.snapValue(Math.max(20,this.resizeStart.height+a));break;case"sw":if(n){const e=this.snapValue(Math.max(20,this.resizeStart.width-t));this.selectedEl.width=e,this.selectedEl.height=this.snapValue(Math.round(e/3*4)),this.selectedEl.left=this.snapValue(this.resizeStart.left+(this.resizeStart.width-e))}else this.selectedEl.width=this.snapValue(Math.max(20,this.resizeStart.width-t)),this.selectedEl.height=this.snapValue(Math.max(20,this.resizeStart.height+a)),this.selectedEl.left=this.snapValue(this.resizeStart.left+t);break;case"ne":if(n){const e=this.snapValue(Math.max(20,this.resizeStart.width+t));this.selectedEl.width=e;const a=this.snapValue(Math.round(e/3*4));this.selectedEl.height=a,this.selectedEl.top=this.snapValue(this.resizeStart.top+(this.resizeStart.height-a))}else this.selectedEl.width=this.snapValue(Math.max(20,this.resizeStart.width+t)),this.selectedEl.height=this.snapValue(Math.max(20,this.resizeStart.height-a)),this.selectedEl.top=this.snapValue(this.resizeStart.top+a);break;case"nw":if(n){const e=this.snapValue(Math.max(20,this.resizeStart.width-t));this.selectedEl.width=e;const a=this.snapValue(Math.round(e/3*4));this.selectedEl.height=a,this.selectedEl.left=this.snapValue(this.resizeStart.left+(this.resizeStart.width-e)),this.selectedEl.top=this.snapValue(this.resizeStart.top+(this.resizeStart.height-a))}else this.selectedEl.width=this.snapValue(Math.max(20,this.resizeStart.width-t)),this.selectedEl.height=this.snapValue(Math.max(20,this.resizeStart.height-a)),this.selectedEl.left=this.snapValue(this.resizeStart.left+t),this.selectedEl.top=this.snapValue(this.resizeStart.top+a);break}},handleRotateStart(e,t){this.rotating=!0,this.rotateStart.x=e.clientX,this.rotateStart.y=e.clientY,this.rotateStart.angle=t.rotate_angle||0;const a=e.target.parentElement.getBoundingClientRect();this.rotateStart.centerX=a.left+a.width/2,this.rotateStart.centerY=a.top+a.height/2},handleRotate(e){const t=e.clientX-this.rotateStart.centerX,a=e.clientY-this.rotateStart.centerY,n=Math.atan2(a,t)*(180/Math.PI)+90;this.selectedEl.rotate_angle=n},deleteSelectedElement(){if(!this.selectedEl)return;const e=this.current_page.els.findIndex(e=>e.id===this.selectedEl.id);-1!==e&&(this.current_page.els.splice(e,1),this.selectedEl=null,this.$AF.$msgSuccess("Đã xóa element"))},async handleObjectDrop(e,t,a){let n=this.unbindObj(this.base_el);switch(n.id=e.id+":"+Date.now(),n.main_object_class=e.main_object_class,n.main_object_id=e.id,n.left=t,n.top=a,e.main_object_class){case"image":n.width=300,n.height=400,n.background_color="#eeeeee",n.border_width=0,n.border_color="#ffffff",n.name=e.title||"Ảnh chụp",n.text_content=e.title||"Ảnh chụp",n.font_size=24,n.font_bold=!0,n.font_color="#000000",n.lock_aspect_ratio=!0;break;case"custom_image":n.image_url=e.image_url,n.name=e.title||"Ảnh tùy chỉnh",n.background_color="#ffffff00";try{const t=await this.getImageDimensions(e.image_url),a=this.view.width;t.width>a?(n.width=a,n.height=a/t.width*t.height):(n.width=t.width,n.height=t.height)}catch(i){n.width=200,n.height=200}break;case"qrcode":n.width=150,n.height=150,n.name="QR Code",n.border_width=1,n.border_color="#000000";let t=await this.genQrCode({data:"https://example.com",size:150});n.image_url=t;break;case"text":n.width=300,n.height=50,n.name="Văn bản",n.text_content="Nhập văn bản...",n.font_size=24,n.font_color="#000000",n.font_family="Arial, sans-serif",n.font_bold=!1,n.font_italic=!1,n.font_underline=!1,n.text_align="left",n.background_color="transparent",n.main_object_class="text";break;default:n.width=150,n.height=150}n.width=this.snapValue(n.width),n.height=this.snapValue(n.height),this.current_page.els.push(n),this.selectedEl=n,this.$AF.$msgSuccess("Đã thêm "+(n.name||"element"))},handleDragOver(e){this.isDraggingOver=!0,e.dataTransfer.dropEffect="copy"},handleDragLeave(e){this.isDraggingOver=!1},async handleDrop(e){this.isDraggingOver=!1;const t=e.currentTarget.getBoundingClientRect(),a=this.snapValue((e.clientX-t.left)/this.view.scale),n=this.snapValue((e.clientY-t.top)/this.view.scale),i=e.dataTransfer.getData("application/json");if(i)try{const e=JSON.parse(i);return void await this.handleObjectDrop(e,a,n)}catch(o){console.error("Error parsing drop data:",o)}const l=(e.target||{}).files||(e.dataTransfer||{}).files||[];if(0===l.length)return;let s=await this.$fetch.base.uploadImage({file:l[0]});if(s.filename){this.$AF.$msgSuccess("Upload ảnh thành công");let e=await this.readFileAsDataURL(l[0]),t=await this.getImageDimensions(e),i=this.unbindObj(this.base_el);i.id="image:"+(this.current_page.els.length+1),i.image_url=this.$fetch.base.getUploadedImage(s.filename);const o=this.view.width;t.width>o?(i.width=o,i.height=o/t.width*t.height):(i.width=t.width,i.height=t.height),i.left=a,i.top=n,this.current_page.els.push(i),this.getCustomObject()}else this.$AF.$msgWarning("Upload ảnh thất bại")},readFileAsDataURL(e){return new Promise((t,a)=>{const n=new FileReader;n.onload=e=>t(e.target.result),n.onerror=a,n.readAsDataURL(e)})},getImageDimensions(e){return new Promise((t,a)=>{const n=new Image;n.onload=()=>{t({width:n.width,height:n.height})},n.onerror=a,n.src=e})},genPageView(){let e=0,t=0,a=(this.current_page.size||"4x6").split("x");2===a.length&&(e=parseFloat(a[0])*(this.current_page.dpi||300),t=parseFloat(a[1])*(this.current_page.dpi||300));let n=window.innerWidth*(1-this.panel_size.main),i=window.innerHeight-50,l=n/e,s=i/t;this.baseScale=Math.min(l,s),this.view.scale=this.baseScale,this.view.width=parseInt(e),this.view.height=parseInt(t),this.view.left=(n-this.view.width*this.view.scale)/2,this.view.top=(i-this.view.height*this.view.scale)/2},async saveTemplate(){if(0!==this.current_page.els.length){if(this.current_page.name.trim().length<3)return this.$AF.$msgWarning("Vui lòng đặt tên cho khung ảnh (ít nhất 3 ký tự)"),this.main_tab="1",void await this.$nextTick(()=>{this.$refs.input_frame_name.focus()});if(await this.$AF.$qConfirm("Bạn có chắc muốn lưu khung ảnh này không?")){this.saving=!0;const t=JSON.parse(JSON.stringify(this.current_page));let a=await V({pageConfig:this.current_page,imageUrls:[],qrCodeUrl:await this.genQrCode({data:"Xin chao"}),options:{}});try{await this.$fetch.base.createOrUpdateFrame({frameData:t,imageFile:a.blob}),this.$AF.$msgSuccess("Đã lưu template"),await this.getAllFrames()}catch(e){this.$AF.$msgWarning("Lỗi khi lưu template"),console.error("Save template error:",e)}finally{this.saving=!1}}}else this.$AF.$msgWarning("Không thể lưu khung ảnh trống")}}};const ga=(0,b.A)(pa,[["render",ra]]);var _a=ga;const ma={style:{"max-width":"calc(100vh - 100px)","min-width":"300px",padding:"32px"}},fa={style:{width:"100%"}},ba={style:{"text-align":"left"}},ka={style:{position:"relative"}},va={class:"custom-arrow"},ya=["onClick"],wa=["onClick"],xa={class:"custom-dots"},Fa=["onClick"];function Ca(e,t,a,n,l,s){const o=(0,i.g2)("n-flex"),r=(0,i.g2)("n-skeleton"),c=(0,i.g2)("n-collapse-transition"),d=(0,i.g2)("Icon"),h=(0,i.g2)("n-input"),u=(0,i.g2)("n-button"),p=(0,i.g2)("n-image"),g=(0,i.g2)("n-carousel"),_=(0,i.g2)("n-scrollbar");return(0,i.uX)(),(0,i.Wv)(_,{class:"background-lib"},{default:(0,i.k6)(()=>[(0,i.bF)(o,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",ma,[(0,i.bF)(c,{show:l.is_loading},{default:(0,i.k6)(()=>[(0,i.bF)(o,{class:"label"},{default:(0,i.k6)(()=>[...t[0]||(t[0]=[(0,i.eW)(" Đang tải thư viện... ",-1)])]),_:1}),(0,i.Lk)("div",fa,[(0,i.bF)(r,{style:{"margin-top":"12px",width:"600px","max-width":"100%",height:"400px","border-radius":"4px"}})])]),_:1},8,["show"]),(0,i.bF)(c,{show:l.image_url.length>0},{default:(0,i.k6)(()=>[(0,i.bF)(o,{class:"label"},{default:(0,i.k6)(()=>[(0,i.bF)(o,{align:"center",direction:"column"},{default:(0,i.k6)(()=>[(0,i.bF)(d,{width:"32px",icon:"solar:calendar-date-bold-duotone"}),(0,i.Lk)("span",null,(0,R.v_)(new Date(1e3*l.info.created_at).toLocaleString()),1)]),_:1})]),_:1}),(0,i.Lk)("div",ba,[t[2]||(t[2]=(0,i.Lk)("p",{class:"field-label",style:{color:"white"}},"Liên kết",-1)),(0,i.bF)(o,{align:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(h,{style:{flex:"1"},value:s.shareURL,readonly:""},null,8,["value"]),(0,i.bF)(u,{type:"primary",onClick:s.copyShareUrl},{default:(0,i.k6)(()=>[...t[1]||(t[1]=[(0,i.eW)("Sao chép",-1)])]),_:1},8,["onClick"])]),_:1})]),t[3]||(t[3]=(0,i.Lk)("div",{style:{"margin-top":"16px"}},null,-1)),(0,i.Lk)("div",ka,[(0,i.bF)(g,{"show-arrow":"",autoplay:""},{arrow:(0,i.k6)(({prev:e,next:t})=>[(0,i.Lk)("div",va,[(0,i.Lk)("button",{type:"button",class:"custom-arrow--left",onClick:e},[(0,i.bF)(d,{icon:"solar:alt-arrow-left-broken",width:"16px"})],8,ya),(0,i.Lk)("button",{type:"button",class:"custom-arrow--right",onClick:t},[(0,i.bF)(d,{icon:"solar:alt-arrow-right-broken",width:"16px"})],8,wa)])]),dots:(0,i.k6)(({total:e,currentIndex:t,to:a})=>[(0,i.Lk)("ul",xa,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e,e=>((0,i.uX)(),(0,i.CE)("li",{key:e,class:(0,R.C4)({["is-active"]:t===e-1}),onClick:t=>a(e-1)},null,10,Fa))),128))])]),default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.image_url,e=>((0,i.uX)(),(0,i.Wv)(p,{src:e,lazy:"",width:"100%",style:{"border-radius":"8px"},"object-fit":"contain"},null,8,["src"]))),256))]),_:1})])]),_:1},8,["show"])])]),_:1})]),_:1})}var La={name:"lib",data(){return{is_loading:!0,image_url:[],image_blobs:[],info:{},is_failed:!1}},computed:{shareURL(){return window.location.href}},beforeMount(){this.getInfo()},beforeUnmount(){Array.isArray(this.image_url)&&this.image_url.forEach(e=>{try{URL.revokeObjectURL(e)}catch(t){}})},methods:{copyShareUrl(){navigator.clipboard.writeText(this.shareURL),this.$AF.$msgSuccess("Đã sao chép liên kết vào bộ nhớ tạm!")},async getInfo(){let e="https://zhikong.ai/api/v1/open-api/anonymous/library?"+new URLSearchParams({...this.$route.query||{}}).toString();this.is_loading=!0;let t=await fetch(e);try{let e=await t.json();const a=e?.data?.image_ids||[];this.image_url.length&&this.image_url.forEach(e=>{try{URL.revokeObjectURL(e)}catch(t){}}),this.image_url=[],this.image_blobs=[];const n=a.map(async e=>{const t="https://zhikong.ai/api/v1/cdn/"+encodeURIComponent(e);try{const e=await fetch(t);if(!e.ok)throw new Error(`Fetch failed ${e.status}`);const a=await e.blob(),n=URL.createObjectURL(a);return{blobUrl:n,blob:a}}catch(a){return console.error("Failed to fetch image id",e,a),null}}),i=await Promise.all(n);i.forEach(e=>{e&&(this.image_url.push(e.blobUrl),this.image_blobs.push(e.blob))}),this.info=e?.data||{},this.is_loading=!1}catch(a){console.log("e",a),this.is_loading=!1,this.is_failed=!0}}}};const $a=(0,b.A)(La,[["render",Ca]]);var Ea=$a;function Sa(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",null,"Directing")}var Ta={name:"direct",data(){return{}},beforeMount(){if(this.$route.query.t){let e=this.unbindObj(this.$route.query||{});delete e.t,this.$router.push({path:decodeURIComponent(this.$route.query.t),query:e})}}};const Ua=(0,b.A)(Ta,[["render",Sa]]);var za=Ua;function Ma(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div")}var Aa={name:"page__headless",mixins:[j],props:{},data(){return{}}};const Ia=(0,b.A)(Aa,[["render",Ma]]);var Va=Ia;const Da=[{path:"/:catchAll(.*)",name:"NotFound",component:za},{path:"",name:"lib",component:za},{path:"/",name:"lib",component:za},{path:"/lib",name:"lib",component:Ea},{path:"/start",name:"start",component:We},{path:"/no_license",name:"no_license",component:Ne},{path:"/setting",name:"setting",component:Wt},{path:"/setting/frame",name:"frame",component:_a},{path:"/headless",name:"headless",component:Va}],Xa=(0,h.aE)({history:(0,h.Bt)("/app/"),routes:Da});var Wa=Xa;const ja="https://invoice-lite.ipos.vn/api",Ra={IMAGE:"image/png,image/jpeg,image/jpg,image/webp",VIDEO:"video/mp4,video/webm,video/m4v,video/avi,video/mpeg",AUDIO:"audio/mp3,audio/mpeg,audio/wav",ANY:"*"},Pa=({save_subject:e=!1,download:t=!1,create_image:a=!1,increase_quality:n=!1,remove_subject_background:i=!1,create_video:l=!1,on_save_subject:s=()=>null,on_download:o=()=>null,on_create_image:r=()=>null,on_increase_quality:c=()=>null,on_remove_subject_background:d=()=>null,on_create_video:h=()=>null})=>[...e?[{label:"Lưu đối tượng",icon:"solar:gallery-wide-linear",onClick:s}]:[],...t?[{label:"Tải xuống",icon:"solar:cloud-download-linear",onClick:o}]:[],...a?[{label:"Tạo ảnh",icon:"solar:gallery-add-broken",onClick:r}]:[],...n?[{label:"Tăng chất lượng",icon:"solar:high-quality-broken",onClick:c}]:[],...i?[{label:"Xoá nền đối tượng",icon:"solar:file-remove-broken",onClick:d}]:[],...l?[{label:"Tạo Video",icon:"solar:videocamera-add-broken",onClick:h}]:[]],qa={initialize:"KH nhập thông tin",payment:"KH đang thanh toán",pending:"Khởi tạo iPOS Invoice",signature:"Đang tạo CKS",tax_registration:"Gửi tờ khai CQT",pos_connect:"Kết nối điểm bán hàng",completed:"Đang sử dụng",failed:"Thanh lý, huỷ bỏ"};Object.keys(qa).map(e=>({value:e,label:qa[e]}));var Oa={$ntf:{},$loading:{},$msg:{},$question:{},$picker:({min:e,max:t,blob:a})=>new Promise(e=>{}),$cropper:()=>{},$appFunc:{getImageBase64:async e=>{const t=await fetch(e),a=await t.blob();return new Promise((e,t)=>{const n=new FileReader;n.readAsDataURL(a),n.onloadend=()=>e(n.result),n.onerror=t})},getImageBase64Loading:e=>new Promise(async t=>{Oa.$loading.start();let a=await Oa.$appFunc.getImageBase64(Na(e));Oa.$loading.finish(),a&&t(a)}),registrationProfileCreateOrUpdate:({base:e,callback:t})=>{}},$startDownload:({file_url:e,file_name:t,file_ex:a="png",download_callback:n,mime_type:i,is_get_blob_only:l=!1})=>{},$loginRequire:()=>{},$creationView:({creation_id:e,creation:t})=>null,$imageView:e=>({}),videoCutter:({videoUrl:e})=>new Promise(e=>{}),$fontPicker:({defaultFont:e})=>new Promise(e=>{}),$qConfirm:e=>new Promise(t=>{Oa.$question.info({title:"Xác nhận",content:e||"Bạn có chắc chắc chắn không?",positiveText:"Chắc chắn",negativeText:"Không",draggable:!0,showIcon:!1,onPositiveClick:()=>{t(!0)},onNegativeClick:()=>{t(null)},positiveButtonProps:{type:"primary"}})}),$handleError:e=>new Promise(t=>{if(e){let t=e;"object"===typeof e&&(t=JSON.stringify(e)),Oa.$msg.error({title:"Lỗi",content:t})}else t()}),$handleResponseError:async e=>new Promise(t=>{if(0===e?.error)t();else{let t=e.message||"Lỗi không xác định";"system_error"===t&&(t="Máy chủ gặp sự cố"),Oa.$msg.error(t)}}),$lockErrorResponse:async({error:e,result:t})=>new Promise(a=>{(async()=>{await Oa.$handleError(e),await Oa.$handleResponseError(t),a()})()}),$msgSuccess:e=>{let t=e&&e.message||e||"Success";Oa.$msg.success(t)},$msgWarning:e=>{let t=e&&e.message||e||"Warning";Oa.$msg.warning(t)},$uploadFileThread:({ref_list:e,on_upload_error:t})=>new Promise(a=>{(async()=>{let n=await Promise.all([...e.filter(e=>e.upload).map(e=>e.upload())]),i=n.find(e=>"string"!==typeof e&&(e.error||e.result.error));i?t&&t(i):a()})()}),$sortData:e=>(e.length>0&&"number"===typeof e[0].sort&&(e=e.sort((e,t)=>e.sort-t.sort)),e),$filter:{$currency:e=>(e||0).toLocaleString("vi-VN")}};const Na=e=>e?(e=e.toString(),e.startsWith("http")||e.startsWith("blob")||e.startsWith("data")?e:ja+"/v1/cdn/"+encodeURIComponent(e)):e,Qa={save_subject:async({url:e,b64:t})=>{e&&!t&&(t=await Oa.$appFunc.getImageBase64Loading(e)),e&&t&&Oa.$appFunc.subjectManagerSave({url:e,b64:t})},download:({url:e})=>{Oa.$startDownload({file_url:e,file_name:"Downloading"})},redirect:({url:e,path:t})=>Wa.push(`${t}?image=${encodeURIComponent(e)}`),create_image:({url:e})=>Qa.redirect({url:e,path:"/creation/image"}),image_quality:({url:e})=>Qa.redirect({url:e,path:"/creation/image/quality"}),image_remove_bg:({url:e})=>Qa.redirect({url:e,path:"/creation/image/rm-bg"}),create_video:({url:e})=>Qa.redirect({url:e,path:"/creation/video/from-image"})};var Ba=a(7387),Ka=a(4185),Ga=a(6909),Ha=a(4751),Ja={name:"App",data(){return{}},computed:{},beforeMount(){Oa.$msg=(0,Ba.J)(),Oa.$ntf=(0,Ka.h)(),Oa.$question=(0,Ga.s)(),Oa.$loading=(0,Ha.z)()},mounted(){window.addEventListener("keyup",e=>{"F9"===e.key&&e.ctrlKey&&this.$router.push({path:"/setting",query:this.$route.query||{}})})},beforeDestroy(){},methods:{}};const Ya=(0,b.A)(Ja,[["render",c]]);var Za=Ya;const en={class:"download-gui__container"},tn={class:"flex-1"},an={class:"file-name"},nn={class:"file-path"};function ln(e,t,a,n,l,s){const o=(0,i.g2)("n-progress"),r=(0,i.g2)("n-flex"),c=(0,i.g2)("n-scrollbar"),d=(0,i.g2)("n-popover");return(0,i.uX)(),(0,i.Wv)(d,{show:l.download_list.length>0,trigger:"manual",placement:"top-start"},{trigger:(0,i.k6)(()=>[...t[0]||(t[0]=[(0,i.Lk)("div",{class:"download-gui"},null,-1)])]),default:(0,i.k6)(()=>[(0,i.Lk)("div",en,[(0,i.bF)(c,{style:{"max-height":"200px","min-height":"40px"}},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.download_list,a=>((0,i.uX)(),(0,i.Wv)(r,{key:a.file_url,class:"file-item",align:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(o,{type:"circle",percentage:a.percent,style:{width:"20px"},color:["red","grey","blue","green"][a.status+1]},{default:(0,i.k6)(()=>[...t[1]||(t[1]=[])]),_:1},8,["percentage","color"]),(0,i.Lk)("div",tn,[(0,i.Lk)("div",an,(0,R.v_)(a.file_name),1),(0,i.Lk)("div",nn,(0,R.v_)(e.srcCDN(a.file_url).substr(0,36))+"...",1)])]),_:2},1024))),128))]),_:1})])]),_:1},8,["show"])}var sn={name:"component__download_gui",data(){return{show:!0,download_list:[],interval_check_download:null,maximum_thread:4}},beforeMount(){this.$AF.$startDownload=({file_url:e,file_name:t,file_ex:a="png",download_callback:n,mime_type:i,is_get_blob_only:l=!1})=>{this.download_list.map(e=>e.file_url);this.download_list.push({file_name:t,file_url:e,file_ex:a,start:new Date,status:0,percent:0,download_callback:n,mime_type:i,is_get_blob_only:l})},this.interval_check_download=setInterval(()=>{let e=this.download_list.filter(e=>0===e.status);if(e>this.maximum_thread)return;let t=e.find(e=>0===e.status);t&&this.downloadFile(t)},1e3)},methods:{async downloadFile(e){e.status=1;try{let t=this.srcCDN(e.file_url);const a=await fetch(t),n=a.body.getReader(),i=+a.headers.get("Content-Length");let l="";if(!l)for(;!l;){l=t.endsWith(".mp4")||t.endsWith(".m4v")?"video/mp4":t.endsWith(".mp3")?"audio/mpeg":t.endsWith(".wav")?"audio/wav":t.endsWith(".ogg")?"audio/ogg":t.endsWith(".webm")?"video/webm":t.endsWith(".gif")?"image/gif":t.endsWith(".png")?"image/png":t.endsWith(".jpg")||t.endsWith(".jpeg")?"image/jpeg":t.endsWith(".json")?"application/json":t.endsWith(".doc")?"application/msword":t.endsWith(".docx")?"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t.endsWith(".xls")?"application/vnd.ms-excel":t.endsWith(".xlsx")?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":t.endsWith(".pdf")?"application/pdf":t.endsWith(".zip")?"application/zip":t.endsWith(".rar")?"application/x-rar-compressed":"application/octet-stream";break}let s=0,o=[];for(;;){const{done:t,value:a}=await n.read();if(t)break;o.push(a),s+=a.length,e.percent=Math.floor(s/i*100)}let r=new Blob(o,{type:l,name:e.file_name||"downloaded_file"});r.name=e.file_name||"downloaded_file";const c=URL.createObjectURL(r);if(e.is_get_blob_only)e.download_callback&&e.download_callback(r),e.status=2;else{const a=document.createElement("a");a.href=c;let n=e.file_name||t.split("/").pop().split("?")[0];if(!n||!n.includes(".")){const t=e.file_ex||(l?l.split("/")[1]:"bin");n=`iPOSInvoice-file.${t}`}a.download=n,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(c),e.status=2}}catch(a){e.status=-1}let t=this.download_list.map(e=>e.file_url).indexOf(e.file_url);this.download_list.splice(t,1)}}};const on=(0,b.A)(sn,[["render",ln]]);var rn=on;const cn={class:"font-picker"},dn=["onClick"],hn=["src"];function un(e,t,a,n,l,s){const o=(0,i.g2)("Icon"),r=(0,i.g2)("n-input"),c=(0,i.g2)("n-flex"),d=(0,i.g2)("component_empty"),h=(0,i.g2)("n-col"),u=(0,i.g2)("n-row"),p=(0,i.g2)("n-scrollbar"),g=(0,i.g2)("component__modal-content"),_=(0,i.g2)("n-modal");return(0,i.uX)(),(0,i.CE)("div",cn,[(0,i.bF)(_,{show:l.show,"onUpdate:show":t[2]||(t[2]=e=>l.show=e)},{default:(0,i.k6)(()=>[(0,i.bF)(g,{title:"Chọn Font chữ",width:"600px",onClose:t[1]||(t[1]=e=>l.show=!1),action_text:`Chọn (${l.selected_font})`,onAction:s.confirmSelectFont},{default:(0,i.k6)(()=>[(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.bF)(r,{style:{"max-width":"300px"},placeholder:"Tìm kiếm font chữ ...",value:l.keyword,"onUpdate:value":t[0]||(t[0]=e=>l.keyword=e)},{prefix:(0,i.k6)(()=>[(0,i.bF)(o,{icon:"solar:magnifer-outline"})]),_:1},8,["value"])]),_:1}),(0,i.bF)(p,{style:{"margin-top":"12px","max-height":"calc(100vh - 300px)","min-height":"100px"}},{default:(0,i.k6)(()=>[0===s._filtered_font_list.length?((0,i.uX)(),(0,i.Wv)(d,{key:0})):(0,i.Q3)("",!0),(0,i.bF)(u,{gutter:12},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s._filtered_font_list,e=>((0,i.uX)(),(0,i.Wv)(h,{span:8},{default:(0,i.k6)(()=>[(0,i.Lk)("div",{onClick:t=>l.selected_font=e.name,class:(0,R.C4)({"font-item":!0,active:l.selected_font===e.name})},[(0,i.Lk)("div",null,[(0,i.Lk)("img",{src:s.getImage(e),alt:""},null,8,hn)]),(0,i.bF)(c,{justify:"center",class:"font-item__name"},{default:(0,i.k6)(()=>[(0,i.Lk)("span",null,(0,R.v_)(e.name),1)]),_:2},1024)],10,dn)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1},8,["action_text","onAction"])]),_:1},8,["show"])])}const pn={class:"empty"};function gn(e,t,a,n,l,s){const o=(0,i.g2)("n-flex");return(0,i.uX)(),(0,i.CE)("div",pn,[(0,i.bF)(o,{justify:"center"},{default:(0,i.k6)(()=>[...t[0]||(t[0]=[(0,i.Lk)("img",{src:"/img/empty.svg",alt:"",style:{width:"100%","max-width":"140px",opacity:".4"}},null,-1)])]),_:1}),(0,i.bF)(o,{justify:"center",style:{"font-size":"12px"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,(0,R.v_)(a.description),1)]),_:1})])}var _n={name:"component_empty",props:{description:{type:String,default:"Chưa có dữ liệu!"}},data(){return{}}};const mn=(0,b.A)(_n,[["render",gn]]);var fn=mn,bn={name:"component__font-picker",components:{Component_empty:fn,Component__modalContent:$t},data(){return{font_list:[],selected_font:"",show:!1,keyword:"",callback:null,SERVER_URL:ja}},computed:{_filtered_font_list(){let e=this.keyword.toLowerCase().trim();return this.font_list.filter(t=>t.keyword.includes(e))}},watch:{show:function(e){e&&0===this.font_list.length&&this.getFontList()}},beforeMount(){this.$AF.$fontPicker=({defaultFont:e})=>new Promise(t=>{this.selected_font=e||this.selected_font,this.callback=t,this.show=!0})},methods:{confirmSelectFont(){this.callback&&this.callback(this.selected_font),this.show=!1},getImage(e){return[ja.replace("/api",""),"font_samples",e.image].join("/")},async getFontList(){let e=await(await this.$fetch.base.getFonts()).json();this.font_list=(e||[]).map(e=>({...e,keyword:e.name.toLowerCase()}))}}};const kn=(0,b.A)(bn,[["render",un]]);var vn=kn,yn=a(5888),wn=(0,i.pM)({name:"Provider",components:{Component__fontPicker:vn,Component__download_gui:rn,App:Za},data(){return{darkTheme:yn.a,viVN:o.A,dateViVN:r.A,theme_config:{fontSize:"13px",common:{primaryColor:"#2215b9",primaryColorHover:"#594fc5",primaryColorPressed:"#5d34af",primaryColorSuppl:"#0f31da",borderRadius:"5px",borderColor:"rgba(235,235,235,1)",borderWidth:0,backgroundColor:"#f5f5f5",fontSize:"13px",border:0,fontWeightStrong:"400",lineHeight:1.3,inputBackgroundColor:"red"},Select:{backgroundColor:"red",peers:{InternalSelection:{textColor:"#FF0000",backgroundColor:"red"}}}},show_login:!1,image_view:{path:""}}},beforeMount(){this.$AF.$imageView=e=>{this.image_view.path=e,this.$nextTick(()=>{this.$refs.image_view.click()})}},methods:{}});const xn=(0,b.A)(wn,[["render",s]]);var Fn=xn,Cn=a(4458);(0,Cn.k)("/app/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var Ln=a(782),$n=(0,Ln.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}}),En=a(6587),Sn=a.n(En);const Tn={class:"file-picker"},Un=["id","accept","multiple"];function zn(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",Tn,[(0,i.Lk)("input",{type:"file",id:l.id,ref:"file_picker",accept:l.accept,multiple:l.max>1,onChange:t[0]||(t[0]=(...e)=>s.handleFileChange&&s.handleFileChange(...e))},null,40,Un)])}var Mn={name:"component__file-picker",data(){return{accept:Ra.IMAGE,max:1,resolve:null,file_picker:(0,i.rk)("file_picker"),id:"",listener:null,blob:!0}},beforeMount(){this.id="file_picker_"+this.generateCode(24),Oa.$picker=({accept:e,max:t,blob:a=!0})=>new Promise(n=>{this.max=t||1,this.accept=e||Ra.IMAGE,this.resolve=n,this.blob=a,this.$nextTick(()=>{this.file_picker.click()})})},mounted(){},beforeDestroy(){},methods:{handleFileChange:function(e){let t=e.clipboardData||{},a=t.files||t.items,n=(e.target||{}).files||(e.dataTransfer||{}).files||a||[],i=[];for(let l=0;l<n.length;l++){let e=n[l];if(this.blob){let t=new Blob([e],{type:e.type,name:e.name});i.push(t)}else i.push(e)}if(i.length>this.max)return this.$AF.$msg.error(`Bạn chỉ được chọn tối đa ${this.max} tệp`),0;this.resolve&&this.resolve(1===this.max?i[0]:i),this.file_picker.value=null}}};const An=(0,b.A)(Mn,[["render",zn]]);var In=An;const Vn={class:"image-cropper"};function Dn(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",Vn)}var Xn={name:"component__image-cropper",data(){return{}}};const Wn=(0,b.A)(Xn,[["render",Dn]]);var jn=Wn;const Rn={class:"input-text-auto"},Pn=["id"],qn=["value"];function On(e,t,a,l,s,o){return(0,i.uX)(),(0,i.CE)("div",Rn,[(0,i.bo)((0,i.Lk)("textarea",{id:s.el_id,rows:"1",onKeyup:t[0]||(t[0]=(...e)=>o.calculateHeight&&o.calculateHeight(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>s.scopeValue=e),onMouseup:t[2]||(t[2]=(...e)=>o.calculateHeight&&o.calculateHeight(...e))},null,40,Pn),[[n.Jo,s.scopeValue]]),(0,i.Lk)("textarea",{value:s.scopeValue,class:(0,R.C4)("fn__hidden_textarea fn_hide_"+s.el_id),rows:"1",tabindex:"-1"},null,10,qn)])}var Nn={name:"component__input-text",props:{modelValue:{type:String,default:()=>"222"}},data(){return{scopeValue:"1",el_id:""}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){this.$emit("update:modelValue",e)}},beforeMount(){this.el_id=`input_text_${this.generateCode(24)}`,this.scopeValue=this.modelValue},mounted(){this.calculateHeight()},methods:{calculateHeight(){let e=this.jquery("#"+this.el_id),t=34,a=4,n=22,i=this.jquery(".fn_hide_"+this.el_id)[0],l=i.scrollHeight-t,s=Math.floor(l/n);e.css({height:s*n+t+a})}}};const Qn=(0,b.A)(Nn,[["render",On]]);var Bn=Qn;const Kn={class:"fn__toggle"},Gn={class:"t_in"},Hn=["disabled"];function Jn(e,t,a,l,s,o){return(0,i.uX)(),(0,i.CE)("label",Kn,[(0,i.Lk)("span",Gn,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>s.scopeValue=e),disabled:a.disabled},null,8,Hn),[[n.lH,s.scopeValue]]),t[1]||(t[1]=(0,i.Lk)("span",{class:"t_slider"},null,-1)),t[2]||(t[2]=(0,i.Lk)("span",{class:"t_content"},null,-1))]),(0,i.RG)(e.$slots,"default")])}var Yn={name:"component__switch",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},data(){return{scopeValue:!1}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){e!==this.modelValue&&this.$emit("update:modelValue",e)}},beforeMount(){this.scopeValue=this.modelValue}};const Zn=(0,b.A)(Yn,[["render",Jn]]);var ei=Zn;const ti={class:"all_models"};function ai(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("div",{class:(0,R.C4)({fn__select_model:!0,opened:l.is_open})},[(0,i.Lk)("a",{class:"model_open",onClick:t[0]||(t[0]=e=>s.handleTrigger("click")),onMouseover:t[1]||(t[1]=e=>s.handleTrigger("over"))},[(0,i.RG)(e.$slots,"ref")],32),(0,i.Lk)("div",ti,[(0,i.RG)(e.$slots,"default")])],2)}var ni={name:"component__popover",props:{trigger:{type:String,default:"click"}},data(){return{is_open:!1}},methods:{handleTrigger(e="click"){if(e!==this.trigger)return 0;this.is_open=!this.is_open}}};const ii=(0,b.A)(ni,[["render",ai]]);var li=ii;const si=["id"],oi=["value"];function ri(e,t,a,l,s,o){return(0,i.bo)(((0,i.uX)(),(0,i.CE)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.scopeValue=e),id:s.id},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.options,e=>((0,i.uX)(),(0,i.CE)("option",{value:e[0]},(0,R.v_)(e[1]),9,oi))),256))],8,si)),[[n.u1,s.scopeValue]])}var ci={name:"component__select-single",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]}},data(){return{scopeValue:"",id:""}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=!1)},scopeValue:function(e){e!==this.modelValue&&this.$emit("update:modelValue",e)}},beforeMount(){this.id=`select-single-${this.generateCode(24)}`,this.scopeValue=this.modelValue}};const di=(0,b.A)(ci,[["render",ri]]);var hi=di;const ui={href:"javascript:0;",class:"sidebar__trigger"};function pi(e,t,a,n,l,s){const o=(0,i.g2)("Icon");return(0,i.uX)(),(0,i.CE)("a",ui,[(0,i.bF)(o,{icon:"solar:settings-broken",height:"24"})])}var gi={name:"component__sidebar-page-trigger",components:{Icon:d.In},data(){return{}}};const _i=(0,b.A)(gi,[["render",pi]]);var mi=_i;const fi={class:"fn__range"},bi={class:"range_in"},ki=["min","max"],vi={class:"value"};function yi(e,t,a,l,s,o){return(0,i.uX)(),(0,i.CE)("div",fi,[(0,i.Lk)("div",bi,[(0,i.bo)((0,i.Lk)("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>s.scopeValue=e),min:a.min,max:a.max},null,8,ki),[[n.Jo,s.scopeValue]]),t[1]||(t[1]=(0,i.Lk)("div",{class:"slider"},null,-1))]),(0,i.Lk)("div",vi,(0,R.v_)(s.scopeValue),1)])}var wi={name:"component__slider",props:{modelValue:{type:Number,default:0},min:{type:Number,default:0},max:{type:Number,default:100}},data(){return{scopeValue:this.modelValue}},watch:{modelValue:function(e){e!==this.scopeValue&&(this.scopeValue=e)},scopeValue:function(e){e!==this.modelValue&&this.$emit("update:modelValue",e)}}};const xi=(0,b.A)(wi,[["render",yi]]);var Fi=xi;const Ci=["title"];function Li(e,t,a,n,l,s){return(0,i.uX)(),(0,i.CE)("span",{class:"fn__tooltip",title:a.content},[(0,i.RG)(e.$slots,"default")],8,Ci)}var $i={name:"component__tooltip",props:{content:{type:String,default:""}},data(){return{}}};const Ei=(0,b.A)($i,[["render",Li]]);var Si=Ei,Ti=a(6777);const Ui=(0,n.Ef)(Fn);let zi={base:new w({service_port:5e3}),server:new D({})};Ui.component("component__file-picker",In).component("component__image-cropper",jn).component("component__input-number",ft).component("component__input-text",Bn).component("component__switch",ei).component("component__popover",li).component("component__select-single",hi).component("component__sidebar-page-trigger",mi).component("component__slider",Fi).component("component__tooltip",Si).component("Icon",d.In),Ui.config.globalProperties.$fetch=zi,Ui.config.globalProperties.jquery=Sn(),Ui.config.globalProperties.timestamp=e=>Math.floor(new Date(e).getTime()/1e3),Ui.config.globalProperties.generateCode=e=>{let t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=a.length;for(let i=0;i<e;i++)t+=a.charAt(Math.floor(Math.random()*n));return t},Ui.config.globalProperties.sleep=e=>new Promise(t=>{setTimeout(()=>{t()},e)}),Ui.config.globalProperties.$AF=Oa,Ui.config.globalProperties.unbindObj=e=>JSON.parse(JSON.stringify(e)),Ui.config.globalProperties.overrideObj=(e,t)=>{let a=Ui.config.globalProperties.unbindObj(t);Object.keys(a).forEach(t=>{e[t]!==a[t]&&(e[t]=a[t])})},Ui.config.globalProperties.removeUnicode=e=>"undefined"===typeof e?"":(e=e.toString().toLowerCase(),e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),e=e.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),e=e.replace(/ì|í|ị|ỉ|ĩ/g,"i"),e=e.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),e=e.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),e=e.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),e=e.replace(/đ/g,"d"),e),Ui.config.globalProperties.srcCDN=Na,Ui.config.globalProperties.imageCDN=Na,Ui.config.globalProperties.INPUT_FILE_TYPE=Ra,Ui.config.globalProperties.createMenuOptions=Pa,Ui.config.globalProperties.menuOptionsFunctions=Qa,Ui.use($n).use(Wa).use(Ti.A).mount("#app")}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,n,i,l){if(!n){var s=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],l=e[d][2];for(var o=!0,r=0;r<n.length;r++)(!1&l||s>=l)&&Object.keys(a.O).every(function(e){return a.O[e](n[r])})?n.splice(r--,1):(o=!1,l<s&&(s=l));if(o){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,i,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,l,s=n[0],o=n[1],r=n[2],c=0;if(s.some(function(t){return 0!==e[t]})){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(r)var d=r(a)}for(t&&t(n);c<s.length;c++)l=s[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(d)},n=self["webpackChunkphotobooth_client"]=self["webpackChunkphotobooth_client"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],function(){return a(2941)});n=a.O(n)})();